<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AeroVuelos Colombia â€” Descubre el mundo</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --red: #D32F2F;
    --red-dark: #B71C1C;
    --red-light: #EF5350;
    --white: #FFFFFF;
    --gray: #F5F5F5;
    --text: #1a1a1a;
    --muted: #666;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    color: var(--text);
    overflow-x: hidden;
  }

  /* NAV */
  nav {
    position: fixed; top: 0; width: 100%; z-index: 100;
    background: rgba(211,47,47,0.97);
    backdrop-filter: blur(10px);
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 40px; height: 64px;
    box-shadow: 0 2px 20px rgba(0,0,0,0.2);
  }

  .nav-logo {
    font-family: 'Playfair Display', serif;
    color: white; font-size: 22px; font-weight: 900;
    letter-spacing: -0.5px; text-decoration: none;
  }

  .nav-links { display: flex; gap: 28px; }
  .nav-links a {
    color: rgba(255,255,255,0.9); text-decoration: none;
    font-size: 14px; font-weight: 500; letter-spacing: 0.3px;
    transition: color 0.2s;
  }
  .nav-links a:hover { color: white; }

  .nav-buttons { display: flex; gap: 12px; }

  .btn-outline {
    border: 1.5px solid rgba(255,255,255,0.7);
    color: white; background: transparent;
    padding: 8px 18px; border-radius: 6px;
    font-size: 13px; font-weight: 500; cursor: pointer;
    transition: all 0.2s;
  }
  .btn-outline:hover { background: rgba(255,255,255,0.15); border-color: white; }

  .btn-white {
    background: white; color: var(--red);
    border: none; padding: 8px 18px; border-radius: 6px;
    font-size: 13px; font-weight: 600; cursor: pointer;
    transition: all 0.2s;
  }
  .btn-white:hover { background: #f0f0f0; transform: translateY(-1px); }

  /* HERO */
  .hero {
    background: linear-gradient(135deg, var(--red-dark) 0%, var(--red) 50%, var(--red-light) 100%);
    min-height: 100vh;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    padding: 80px 20px 60px;
    position: relative; overflow: hidden;
  }

  .hero::before {
    content: '';
    position: absolute; top: -50%; right: -20%;
    width: 600px; height: 600px;
    background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%);
    border-radius: 50%;
  }

  .hero::after {
    content: '';
    position: absolute; bottom: -30%; left: -10%;
    width: 400px; height: 400px;
    background: radial-gradient(circle, rgba(0,0,0,0.1) 0%, transparent 70%);
    border-radius: 50%;
  }

  .hero-badge {
    background: rgba(255,255,255,0.15);
    border: 1px solid rgba(255,255,255,0.3);
    color: white; padding: 6px 16px; border-radius: 20px;
    font-size: 12px; font-weight: 500; letter-spacing: 1px;
    text-transform: uppercase; margin-bottom: 24px;
    backdrop-filter: blur(5px);
    animation: fadeInDown 0.8s ease;
  }

  .hero h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(40px, 7vw, 72px);
    color: white; text-align: center;
    line-height: 1.1; font-weight: 900;
    margin-bottom: 16px;
    animation: fadeInUp 0.8s ease 0.1s both;
  }

  .hero p {
    color: rgba(255,255,255,0.85); font-size: 17px;
    text-align: center; margin-bottom: 40px;
    animation: fadeInUp 0.8s ease 0.2s both;
  }

  /* SEARCH BOX */
  .search-box {
    background: white;
    border-radius: 16px;
    padding: 28px 32px;
    width: 100%; max-width: 780px;
    box-shadow: 0 24px 64px rgba(0,0,0,0.25);
    animation: fadeInUp 0.8s ease 0.3s both;
    position: relative; z-index: 2;
  }

  .tab-btns { display: flex; gap: 8px; margin-bottom: 24px; }
  .tab-btn {
    padding: 8px 20px; border-radius: 20px; border: none;
    font-size: 13px; font-weight: 500; cursor: pointer;
    background: var(--gray); color: var(--muted);
    transition: all 0.2s;
  }
  .tab-btn.active { background: var(--red); color: white; }

  .search-fields {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    gap: 12px; margin-bottom: 16px;
  }

  .field-group { display: flex; flex-direction: column; }
  .field-label { font-size: 11px; font-weight: 600; color: var(--muted); letter-spacing: 0.5px; text-transform: uppercase; margin-bottom: 6px; }
  .field-input {
    border: 1.5px solid #e0e0e0; border-radius: 8px;
    padding: 10px 14px; font-size: 14px; font-family: 'DM Sans', sans-serif;
    transition: border-color 0.2s; outline: none;
    background: #fafafa;
  }
  .field-input:focus { border-color: var(--red); background: white; }

  .search-bottom {
    display: flex; align-items: center; justify-content: space-between;
    flex-wrap: wrap; gap: 12px;
  }

  .pax-cabin { display: flex; gap: 12px; }

  .btn-search {
    background: var(--red); color: white;
    border: none; padding: 14px 32px; border-radius: 10px;
    font-size: 15px; font-weight: 600; cursor: pointer;
    transition: all 0.2s; display: flex; align-items: center; gap: 8px;
    font-family: 'DM Sans', sans-serif;
  }
  .btn-search:hover { background: var(--red-dark); transform: translateY(-2px); box-shadow: 0 8px 20px rgba(211,47,47,0.4); }

  /* FEATURES STRIP */
  .features {
    padding: 60px 40px 0;
    display: flex; gap: 32px; justify-content: center; flex-wrap: wrap;
    background: white;
  }
  .feature-card { text-align: center; max-width: 190px; }
  .feature-icon {
    width: 56px; height: 56px; margin: 0 auto 14px;
    background: #fff0f0; border-radius: 16px;
    display: flex; align-items: center; justify-content: center; font-size: 26px;
  }
  .feature-card h3 { font-size: 15px; font-weight: 600; margin-bottom: 6px; }
  .feature-card p { font-size: 13px; color: var(--muted); line-height: 1.5; }

  /* ===== SECCIÃ“N DESTINOS DESTACADOS ===== */
  .section-destinos {
    padding: 80px 40px;
    background: white;
  }
  .section-header {
    text-align: center; margin-bottom: 48px;
  }
  .section-header .badge {
    display: inline-block;
    background: #fff0f0; color: var(--red);
    font-size: 11px; font-weight: 700; letter-spacing: 1.5px;
    text-transform: uppercase; padding: 5px 14px; border-radius: 20px;
    margin-bottom: 14px;
  }
  .section-header h2 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(28px,4vw,42px); font-weight: 900;
    color: var(--text); margin-bottom: 10px;
  }
  .section-header p { font-size: 16px; color: var(--muted); }

  /* Grid de destinos */
  .destinos-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: auto auto;
    gap: 20px;
    max-width: 1100px; margin: 0 auto 80px;
  }
  .destino-card {
    position: relative; border-radius: 20px; overflow: hidden;
    cursor: pointer; transition: transform 0.3s, box-shadow 0.3s;
    box-shadow: 0 4px 20px rgba(0,0,0,0.12);
  }
  .destino-card:hover { transform: translateY(-6px); box-shadow: 0 16px 40px rgba(0,0,0,0.2); }
  .destino-card.big { grid-row: span 2; }

  .destino-img {
    width: 100%; height: 100%; object-fit: cover;
    display: block; transition: transform 0.5s;
    min-height: 200px;
  }
  .destino-card.big .destino-img { min-height: 440px; }
  .destino-card:hover .destino-img { transform: scale(1.05); }

  .destino-overlay {
    position: absolute; inset: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.75) 0%, rgba(0,0,0,0.1) 60%, transparent 100%);
    display: flex; flex-direction: column; justify-content: flex-end;
    padding: 22px;
  }
  .destino-tag {
    display: inline-block; background: var(--red); color: white;
    font-size: 10px; font-weight: 700; letter-spacing: 1px;
    text-transform: uppercase; padding: 3px 10px; border-radius: 10px;
    margin-bottom: 6px; width: fit-content;
  }
  .destino-nombre { font-family: 'Playfair Display', serif; font-size: 22px; color: white; font-weight: 700; margin-bottom: 3px; }
  .destino-card.big .destino-nombre { font-size: 30px; }
  .destino-pais { font-size: 12px; color: rgba(255,255,255,0.8); margin-bottom: 8px; }
  .destino-precio {
    display: inline-flex; align-items: center; gap: 6px;
    background: white; color: var(--red);
    font-size: 13px; font-weight: 700; padding: 5px 12px; border-radius: 20px;
    width: fit-content;
  }

  /* ===== SECCIÃ“N PLAYAS ===== */
  .section-playas { padding: 0 40px 80px; background: white; }
  .playas-scroll {
    display: flex; gap: 20px; overflow-x: auto; padding-bottom: 12px;
    scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch;
    max-width: 1100px; margin: 0 auto;
  }
  .playas-scroll::-webkit-scrollbar { height: 4px; }
  .playas-scroll::-webkit-scrollbar-track { background: #f0f0f0; border-radius: 4px; }
  .playas-scroll::-webkit-scrollbar-thumb { background: var(--red); border-radius: 4px; }

  .playa-card {
    flex: 0 0 260px; border-radius: 18px; overflow: hidden;
    position: relative; scroll-snap-align: start;
    cursor: pointer; transition: transform 0.3s;
    box-shadow: 0 4px 16px rgba(0,0,0,0.12);
  }
  .playa-card:hover { transform: translateY(-5px); }
  .playa-img { width: 100%; height: 320px; object-fit: cover; display: block; transition: transform 0.4s; }
  .playa-card:hover .playa-img { transform: scale(1.06); }
  .playa-overlay {
    position: absolute; inset: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 55%);
    padding: 20px; display: flex; flex-direction: column; justify-content: flex-end;
  }
  .playa-badge {
    display: inline-block; background: rgba(255,255,255,0.2);
    border: 1px solid rgba(255,255,255,0.4); backdrop-filter: blur(4px);
    color: white; font-size: 10px; font-weight: 600; letter-spacing: 1px;
    text-transform: uppercase; padding: 3px 10px; border-radius: 10px;
    margin-bottom: 6px; width: fit-content;
  }
  .playa-nombre { font-family: 'Playfair Display', serif; font-size: 20px; color: white; font-weight: 700; margin-bottom: 2px; }
  .playa-pais { font-size: 12px; color: rgba(255,255,255,0.75); margin-bottom: 8px; }
  .playa-temp {
    display: flex; align-items: center; gap: 6px;
    font-size: 12px; color: white; font-weight: 600;
  }
  .playa-temp span { background: rgba(255,255,255,0.15); padding: 2px 8px; border-radius: 10px; }

  /* ===== BANNER OFERTA ===== */
  .oferta-banner {
    margin: 0 40px 80px; border-radius: 24px; overflow: hidden;
    position: relative; max-width: 1100px; margin-left: auto; margin-right: auto;
  }
  .oferta-banner img {
    width: 100%; height: 280px; object-fit: cover; display: block;
    filter: brightness(0.55);
  }
  .oferta-content {
    position: absolute; inset: 0;
    display: flex; flex-direction: column; justify-content: center;
    align-items: center; text-align: center; padding: 40px;
  }
  .oferta-content h3 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(28px,4vw,48px); color: white; font-weight: 900;
    margin-bottom: 12px; line-height: 1.1;
  }
  .oferta-content p { font-size: 16px; color: rgba(255,255,255,0.85); margin-bottom: 24px; }
  .btn-oferta {
    background: white; color: var(--red);
    padding: 13px 32px; border-radius: 40px;
    font-size: 15px; font-weight: 700; cursor: pointer;
    border: none; transition: all 0.2s; font-family: 'DM Sans', sans-serif;
    box-shadow: 0 4px 20px rgba(0,0,0,0.25);
  }
  .btn-oferta:hover { transform: translateY(-2px); box-shadow: 0 8px 28px rgba(0,0,0,0.3); }

  @media (max-width: 768px) {
    .destinos-grid { grid-template-columns: 1fr 1fr; }
    .destino-card.big { grid-row: span 1; }
    .destino-card.big .destino-img { min-height: 220px; }
    .section-destinos, .section-playas { padding-left: 20px; padding-right: 20px; }
    .oferta-banner { margin-left: 20px; margin-right: 20px; }
  }
  @media (max-width: 500px) {
    .destinos-grid { grid-template-columns: 1fr; }
  }

  /* MODALS */
  .modal-overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
    z-index: 1000; align-items: center; justify-content: center;
  }
  .modal-overlay.active { display: flex; }

  .modal {
    background: white; border-radius: 20px;
    padding: 40px; width: 90%; max-width: 480px;
    box-shadow: 0 40px 80px rgba(0,0,0,0.3);
    animation: modalIn 0.3s ease;
    position: relative; max-height: 90vh; overflow-y: auto;
  }

  .modal-close {
    position: absolute; top: 16px; right: 16px;
    background: var(--gray); border: none; width: 32px; height: 32px;
    border-radius: 50%; cursor: pointer; font-size: 18px;
    display: flex; align-items: center; justify-content: center;
    color: var(--muted);
  }
  .modal-close:hover { background: #e0e0e0; }

  .modal h2 {
    font-family: 'Playfair Display', serif;
    font-size: 26px; margin-bottom: 8px;
  }
  .modal .subtitle { color: var(--muted); font-size: 14px; margin-bottom: 28px; }

  .form-group { margin-bottom: 18px; }
  .form-label { font-size: 13px; font-weight: 600; color: var(--muted); text-transform: uppercase; letter-spacing: 0.4px; margin-bottom: 6px; display: block; }
  .form-input {
    width: 100%; border: 1.5px solid #e0e0e0; border-radius: 10px;
    padding: 12px 16px; font-size: 14px; font-family: 'DM Sans', sans-serif;
    outline: none; transition: border-color 0.2s;
  }
  .form-input:focus { border-color: var(--red); }

  .btn-red {
    width: 100%; background: var(--red); color: white;
    border: none; padding: 14px; border-radius: 10px;
    font-size: 15px; font-weight: 600; cursor: pointer;
    transition: all 0.2s; font-family: 'DM Sans', sans-serif;
    margin-top: 8px;
  }
  .btn-red:hover { background: var(--red-dark); }

  .switch-text {
    text-align: center; margin-top: 16px; font-size: 13px; color: var(--muted);
  }
  .switch-text a { color: var(--red); cursor: pointer; font-weight: 600; text-decoration: none; }

  /* PAYMENT MODAL */
  .payment-methods { display: flex; gap: 10px; margin-bottom: 20px; }
  .pay-method {
    flex: 1; border: 2px solid #e0e0e0; border-radius: 10px;
    padding: 12px; text-align: center; cursor: pointer;
    transition: all 0.2s; font-size: 13px; font-weight: 500;
  }
  .pay-method.selected { border-color: var(--red); background: #fff5f5; color: var(--red); }
  .pay-method-icon { font-size: 24px; margin-bottom: 4px; }

  .info-box {
    background: #fff8e1; border: 1px solid #ffe082;
    border-radius: 10px; padding: 14px; font-size: 13px;
    color: #795548; margin-bottom: 16px; line-height: 1.5;
  }
  .info-box strong { display: block; margin-bottom: 4px; color: #5D4037; }

  .price-summary {
    background: var(--gray); border-radius: 10px; padding: 16px;
    margin-bottom: 20px;
  }
  .price-row { display: flex; justify-content: space-between; font-size: 14px; margin-bottom: 8px; }
  .price-row.total { font-weight: 700; font-size: 16px; border-top: 1px solid #ddd; padding-top: 10px; margin-top: 4px; }

  /* RESULTS */
  .results-modal .modal { max-width: 640px; }
  .flight-card {
    border: 1.5px solid #e0e0e0; border-radius: 12px; padding: 16px;
    margin-bottom: 12px; transition: all 0.2s; cursor: pointer;
  }
  .flight-card:hover { border-color: var(--red); box-shadow: 0 4px 12px rgba(211,47,47,0.1); }
  .flight-card.selected { border-color: var(--red); background: #fff5f5; }
  .flight-header { display: flex; justify-content: space-between; align-items: center; }
  .flight-route { font-size: 18px; font-weight: 700; }
  .flight-price { font-size: 20px; font-weight: 700; color: var(--red); }
  .flight-details { font-size: 13px; color: var(--muted); margin-top: 6px; }

  .toast {
    position: fixed; bottom: 30px; right: 30px; z-index: 9999;
    background: #333; color: white; padding: 14px 22px;
    border-radius: 10px; font-size: 14px; font-weight: 500;
    box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    animation: slideUp 0.3s ease;
    display: none;
  }
  .toast.show { display: block; }
  .toast.success { background: #2e7d32; }
  .toast.error { background: #c62828; }

  /* TICKET MODAL */
  .ticket-modal .modal { max-width: 560px; }

  .ticket-header {
    background: linear-gradient(135deg, var(--red-dark), var(--red));
    color: white; border-radius: 14px; padding: 24px 28px; margin-bottom: 0;
    display: flex; justify-content: space-between; align-items: center;
  }
  .ticket-header .airline { font-family: 'Playfair Display', serif; font-size: 22px; font-weight: 900; }
  .ticket-header .code-label { font-size: 11px; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px; }
  .ticket-header .code-val { font-size: 24px; font-weight: 700; letter-spacing: 2px; }

  .ticket-body {
    border: 2px dashed #e0e0e0; border-top: none;
    border-radius: 0 0 14px 14px; padding: 24px 28px;
    background: #fafafa;
  }

  .ticket-route {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 20px;
  }
  .ticket-city { text-align: center; }
  .ticket-city .iata { font-size: 32px; font-weight: 700; font-family: 'Playfair Display', serif; }
  .ticket-city .name { font-size: 12px; color: var(--muted); }
  .ticket-arrow { font-size: 24px; color: var(--red); }

  .ticket-grid {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 14px; margin-bottom: 16px;
  }
  .ticket-field { }
  .ticket-field .t-label { font-size: 10px; font-weight: 600; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 3px; }
  .ticket-field .t-val { font-size: 14px; font-weight: 600; color: var(--text); }

  .ticket-divider {
    border: none; border-top: 2px dashed #ddd; margin: 16px 0;
  }

  .ticket-extras {
    background: white; border-radius: 10px; border: 1px solid #e8e8e8;
    padding: 14px; margin-bottom: 16px;
  }
  .ticket-extras h4 { font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; color: var(--muted); margin-bottom: 10px; }
  .extras-row { display: flex; justify-content: space-between; font-size: 13px; padding: 5px 0; border-bottom: 1px solid #f0f0f0; }
  .extras-row:last-child { border-bottom: none; }
  .extras-row span:first-child { color: var(--muted); }
  .extras-row span:last-child { font-weight: 600; }

  .ticket-conditions {
    background: #fff8e1; border: 1px solid #ffe082; border-radius: 10px;
    padding: 12px 14px; font-size: 12px; color: #795548; line-height: 1.6;
    margin-bottom: 16px;
  }
  .ticket-conditions strong { display: block; color: #5D4037; margin-bottom: 4px; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; }

  .ticket-actions { display: flex; gap: 10px; }
  .btn-download {
    flex: 1; background: var(--red); color: white; border: none;
    padding: 12px; border-radius: 10px; font-size: 14px; font-weight: 600;
    cursor: pointer; transition: all 0.2s; font-family: 'DM Sans', sans-serif;
    display: flex; align-items: center; justify-content: center; gap: 6px;
  }
  .btn-download:hover { background: var(--red-dark); }
  .btn-share {
    flex: 1; background: #f0f0f0; color: var(--text); border: none;
    padding: 12px; border-radius: 10px; font-size: 14px; font-weight: 600;
    cursor: pointer; transition: all 0.2s; font-family: 'DM Sans', sans-serif;
    display: flex; align-items: center; justify-content: center; gap: 6px;
  }
  .btn-share:hover { background: #e0e0e0; }

  #ticketPrintArea { display: none; }

  @media print {
    body > *:not(#ticketPrintArea) { display: none !important; }
    #ticketPrintArea { display: block !important; }
  }


  /* ===== PANEL ADMIN ===== */
  .admin-overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.85); z-index: 2000;
    align-items: flex-start; justify-content: center;
    overflow-y: auto; padding: 20px;
  }
  .admin-overlay.active { display: flex; }
  .admin-panel {
    background: #1a1a2e; color: white;
    border-radius: 20px; width: 100%; max-width: 780px;
    margin: auto; overflow: hidden;
    box-shadow: 0 40px 80px rgba(0,0,0,0.6);
  }
  .admin-header {
    background: linear-gradient(135deg, #16213e, #0f3460);
    padding: 20px 28px; display: flex; justify-content: space-between; align-items: center;
  }
  .admin-header h2 { font-family: 'Playfair Display', serif; font-size: 20px; color: white; }
  .admin-header .badge { background: #e94560; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 700; }
  .admin-tabs { display: flex; background: #16213e; border-bottom: 1px solid rgba(255,255,255,0.1); }
  .admin-tab {
    flex: 1; padding: 12px; text-align: center; font-size: 13px; font-weight: 600;
    cursor: pointer; color: rgba(255,255,255,0.5); transition: all 0.2s;
    border-bottom: 3px solid transparent;
  }
  .admin-tab.active { color: #e94560; border-bottom-color: #e94560; background: rgba(233,69,96,0.08); }
  .admin-tab:hover { color: white; }
  .admin-body { padding: 20px 24px; max-height: 70vh; overflow-y: auto; }
  .admin-stat-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 12px; margin-bottom: 20px; }
  .admin-stat {
    background: rgba(255,255,255,0.07); border-radius: 12px; padding: 16px; text-align: center;
    border: 1px solid rgba(255,255,255,0.1);
  }
  .admin-stat .num { font-size: 28px; font-weight: 900; color: #e94560; }
  .admin-stat .lbl { font-size: 11px; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.5px; margin-top: 4px; }
  .admin-event {
    background: rgba(255,255,255,0.05); border-radius: 10px; padding: 14px 16px;
    margin-bottom: 10px; border-left: 3px solid #e94560;
    font-size: 13px;
  }
  .admin-event .ev-type { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; color: #e94560; margin-bottom: 4px; }
  .admin-event .ev-fecha { font-size: 11px; color: rgba(255,255,255,0.4); margin-top: 6px; }
  .admin-event .ev-detail { color: rgba(255,255,255,0.85); line-height: 1.5; }
  .admin-event.registro { border-left-color: #4caf50; }
  .admin-event.registro .ev-type { color: #4caf50; }
  .admin-event.busqueda { border-left-color: #2196f3; }
  .admin-event.busqueda .ev-type { color: #64b5f6; }
  .admin-user-card {
    background: rgba(255,255,255,0.05); border-radius: 10px; padding: 14px 16px;
    margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;
  }
  .admin-user-card .u-name { font-weight: 700; font-size: 14px; }
  .admin-user-card .u-info { font-size: 12px; color: rgba(255,255,255,0.5); margin-top: 3px; }
  .admin-wpp-btn {
    background: #25d366; color: white; border: none;
    padding: 8px 14px; border-radius: 8px; font-size: 12px; font-weight: 700;
    cursor: pointer; white-space: nowrap;
  }
  .admin-res-card {
    background: rgba(255,255,255,0.05); border-radius: 10px; padding: 14px 16px;
    margin-bottom: 10px; border: 1px solid rgba(255,255,255,0.1);
  }
  .admin-res-card .res-code { font-size: 18px; font-weight: 900; color: #e94560; }
  .admin-res-card .res-ruta { font-size: 14px; font-weight: 600; margin: 4px 0; }
  .admin-res-card .res-info { font-size: 12px; color: rgba(255,255,255,0.5); line-height: 1.7; }
  .res-estado {
    display: inline-block; padding: 2px 10px; border-radius: 10px;
    font-size: 11px; font-weight: 700; text-transform: uppercase;
  }
  .res-estado.pendiente { background: rgba(255,193,7,0.2); color: #ffc107; }
  .res-estado.confirmado { background: rgba(76,175,80,0.2); color: #4caf50; }
  .admin-close {
    background: rgba(255,255,255,0.1); border: none; color: white;
    width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 18px;
  }
  .admin-login { padding: 40px 24px; text-align: center; }
  .admin-login h3 { color: white; margin-bottom: 20px; font-size: 18px; }
  .admin-login input {
    width: 100%; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
    border-radius: 10px; padding: 12px 16px; color: white; font-size: 14px;
    margin-bottom: 12px; outline: none;
  }
  .admin-login input::placeholder { color: rgba(255,255,255,0.3); }
  .btn-admin-login {
    width: 100%; background: #e94560; color: white; border: none;
    padding: 13px; border-radius: 10px; font-size: 15px; font-weight: 700;
    cursor: pointer; font-family: 'DM Sans', sans-serif;
  }
  .tab-content { display: none; }
  .tab-content.active { display: block; }
  #adminNoData { text-align:center; padding:30px; color:rgba(255,255,255,0.3); font-size:14px; }

  @keyframes fadeInDown { from { opacity:0; transform:translateY(-20px); } to { opacity:1; transform:translateY(0); } }
  @keyframes fadeInUp { from { opacity:0; transform:translateY(30px); } to { opacity:1; transform:translateY(0); } }
  @keyframes modalIn { from { opacity:0; transform:scale(0.9) translateY(20px); } to { opacity:1; transform:scale(1) translateY(0); } }
  @keyframes slideUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }

  @media (max-width: 640px) {
    nav { padding: 0 16px; }
    .nav-links { display: none; }
    .search-fields { grid-template-columns: 1fr 1fr; }
    .search-box { padding: 20px 16px; }
    .features { padding: 60px 20px; }
    .pax-cabin { flex-direction: column; }
  }
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a class="nav-logo" href="#" ondblclick="document.getElementById('adminPanel').classList.add('active')">âœˆ AeroVuelos</a>
  <div class="nav-links">
    <a href="#">Destinos</a>
    <a href="#">Vuelos</a>
    <a href="#">Millas</a>
    <a href="#">Ofertas</a>
    <a href="#">Check-in</a>
  </div>
  <div class="nav-buttons">
    <button class="btn-outline" onclick="openModal('loginModal')">Iniciar sesiÃ³n</button>
    <button class="btn-white" onclick="openModal('registerModal')">Registrarse</button>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-badge">âœ¦ FLY SMARTER. FLY AEROVUELOS.</div>
  <h1>Descubre el mundo<br>desde Colombia</h1>
  <p>MÃ¡s de 100 destinos nacionales e internacionales te esperan</p>

  <!-- SEARCH BOX -->
  <div class="search-box">
    <div class="tab-btns">
      <button class="tab-btn active" onclick="setTab(this,'idaVuelta')">Ida y vuelta</button>
      <button class="tab-btn" onclick="setTab(this,'soloIda')">Solo ida</button>
      <button class="tab-btn" onclick="setTab(this,'multi')">Multidestino</button>
    </div>

    <div class="search-fields">
      <div class="field-group">
        <label class="field-label">Origen</label>
        <input class="field-input" id="origen" type="text" placeholder="Ej: BogotÃ¡ o BOG" value="BogotÃ¡">
      </div>
      <div class="field-group">
        <label class="field-label">Destino</label>
        <input class="field-input" id="destino" type="text" placeholder="Ej: MedellÃ­n o MED">
      </div>
      <div class="field-group">
        <label class="field-label">Fecha de ida</label>
        <input class="field-input" id="fechaIda" type="date">
      </div>
      <div class="field-group" id="fechaVueltaGroup">
        <label class="field-label">Fecha de vuelta</label>
        <input class="field-input" id="fechaVuelta" type="date">
      </div>
    </div>

    <div class="search-bottom">
      <div class="pax-cabin">
        <div class="field-group">
          <label class="field-label">Pasajeros</label>
          <select class="field-input" id="pasajeros">
            <option>1 adulto</option>
            <option>2 adultos</option>
            <option>3 adultos</option>
            <option>4 adultos</option>
          </select>
        </div>
        <div class="field-group">
          <label class="field-label">Cabina</label>
          <select class="field-input" id="cabina">
            <option>EconÃ³mica</option>
            <option>Ejecutiva</option>
            <option>Primera clase</option>
          </select>
        </div>
      </div>
      <button class="btn-search" onclick="buscarVuelos()">
        ğŸ” Buscar vuelos â†’
      </button>
    </div>
  </div>
</section>

<!-- FEATURES STRIP -->
<div class="features">
  <div class="feature-card">
    <div class="feature-icon">âœˆï¸</div>
    <h3>Rutas directas</h3>
    <p>Vuelos sin escalas a los destinos mÃ¡s populares de AmÃ©rica y Europa</p>
  </div>
  <div class="feature-card">
    <div class="feature-icon">â­</div>
    <h3>Millas</h3>
    <p>Acumula millas en cada vuelo y canjÃ©alas por tiquetes y beneficios</p>
  </div>
  <div class="feature-card">
    <div class="feature-icon">ğŸ”„</div>
    <h3>Cambios flexibles</h3>
    <p>Modifica tu reserva sin cargos adicionales con tarifas flex</p>
  </div>
  <div class="feature-card">
    <div class="feature-icon">ğŸ“±</div>
    <h3>Check-in digital</h3>
    <p>Realiza tu check-in desde la app y llega directo a la puerta</p>
  </div>
</div>

<!-- ===== DESTINOS DESTACADOS ===== -->
<section class="section-destinos">
  <div class="section-header">
    <div class="badge">âœˆ Destinos populares</div>
    <h2>Â¿A dÃ³nde quieres volar?</h2>
    <p>Los destinos mÃ¡s reservados por colombianos esta temporada</p>
  </div>

  <div class="destinos-grid">
    <!-- Grande izquierda -->
    <div class="destino-card big" onclick="irADestino('Cartagena')">
      <img class="destino-img" src="https://images.unsplash.com/photo-1583000507497-7a3ae9e3ebf7?w=600&q=80" alt="Cartagena" loading="lazy">
      <div class="destino-overlay">
        <span class="destino-tag">ğŸ– Playa</span>
        <div class="destino-nombre">Cartagena</div>
        <div class="destino-pais">Colombia Â· Costa Caribe</div>
        <div class="destino-precio">âœˆ Desde $310.000 COP</div>
      </div>
    </div>

    <!-- Columna derecha top -->
    <div class="destino-card" onclick="irADestino('MedellÃ­n')">
      <img class="destino-img" src="https://images.unsplash.com/photo-1596451190630-186aff535bf2?w=500&q=80" alt="MedellÃ­n" loading="lazy">
      <div class="destino-overlay">
        <span class="destino-tag">ğŸŒ† Ciudad</span>
        <div class="destino-nombre">MedellÃ­n</div>
        <div class="destino-pais">Colombia Â· Antioquia</div>
        <div class="destino-precio">âœˆ Desde $180.000 COP</div>
      </div>
    </div>
    <div class="destino-card" onclick="irADestino('San AndrÃ©s')">
      <img class="destino-img" src="https://images.unsplash.com/photo-1559494007-9f5847c49d94?w=500&q=80" alt="San AndrÃ©s" loading="lazy">
      <div class="destino-overlay">
        <span class="destino-tag">ğŸ Isla</span>
        <div class="destino-nombre">San AndrÃ©s</div>
        <div class="destino-pais">Colombia Â· Caribe insular</div>
        <div class="destino-precio">âœˆ Desde $420.000 COP</div>
      </div>
    </div>

    <!-- Fila inferior 3 tarjetas -->
    <div class="destino-card" onclick="irADestino('Miami')">
      <img class="destino-img" src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=500&q=80" alt="Miami" loading="lazy">
      <div class="destino-overlay">
        <span class="destino-tag">ğŸ‡ºğŸ‡¸ Internacional</span>
        <div class="destino-nombre">Miami</div>
        <div class="destino-pais">Estados Unidos Â· Florida</div>
        <div class="destino-precio">âœˆ Desde $1.200.000 COP</div>
      </div>
    </div>
    <div class="destino-card" onclick="irADestino('CancÃºn')">
      <img class="destino-img" src="https://images.unsplash.com/photo-1510097467424-192d713fd8b2?w=500&q=80" alt="CancÃºn" loading="lazy">
      <div class="destino-overlay">
        <span class="destino-tag">ğŸ– Playa</span>
        <div class="destino-nombre">CancÃºn</div>
        <div class="destino-pais">MÃ©xico Â· Quintana Roo</div>
        <div class="destino-precio">âœˆ Desde $980.000 COP</div>
      </div>
    </div>
    <div class="destino-card" onclick="irADestino('Madrid')">
      <img class="destino-img" src="https://images.unsplash.com/photo-1539037116277-4db20889f2d4?w=500&q=80" alt="Madrid" loading="lazy">
      <div class="destino-overlay">
        <span class="destino-tag">ğŸ‡ªğŸ‡¸ Europa</span>
        <div class="destino-nombre">Madrid</div>
        <div class="destino-pais">EspaÃ±a Â· Europa</div>
        <div class="destino-precio">âœˆ Desde $2.800.000 COP</div>
      </div>
    </div>
  </div>
</section>

<!-- ===== PLAYAS PARADISÃACAS ===== -->
<section class="section-playas">
  <div class="section-header">
    <div class="badge">ğŸŒŠ Especial playas</div>
    <h2>ParaÃ­sos de arena y mar</h2>
    <p>Los mejores destinos de playa te esperan</p>
  </div>

  <div class="playas-scroll">
    <div class="playa-card" onclick="irADestino('Playa Blanca')">
      <img class="playa-img" src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=400&q=80" alt="Playa Blanca" loading="lazy">
      <div class="playa-overlay">
        <span class="playa-badge">Caribe ğŸ‡¨ğŸ‡´</span>
        <div class="playa-nombre">Playa Blanca</div>
        <div class="playa-pais">BolÃ­var, Colombia</div>
        <div class="playa-temp">ğŸŒ¡ <span>27â€“31Â°C</span> &nbsp; ğŸŒŠ <span>Aguas turquesa</span></div>
      </div>
    </div>

    <div class="playa-card" onclick="irADestino('Punta Cana')">
      <img class="playa-img" src="https://images.unsplash.com/photo-1500375592092-40eb2168fd21?w=400&q=80" alt="Punta Cana" loading="lazy">
      <div class="playa-overlay">
        <span class="playa-badge">Caribe ğŸ‡©ğŸ‡´</span>
        <div class="playa-nombre">Punta Cana</div>
        <div class="playa-pais">RepÃºblica Dominicana</div>
        <div class="playa-temp">ğŸŒ¡ <span>28â€“33Â°C</span> &nbsp; ğŸŒ´ <span>All inclusive</span></div>
      </div>
    </div>

    <div class="playa-card" onclick="irADestino('CancÃºn')">
      <img class="playa-img" src="https://images.unsplash.com/photo-1510097467424-192d713fd8b2?w=400&q=80" alt="CancÃºn" loading="lazy">
      <div class="playa-overlay">
        <span class="playa-badge">Caribe ğŸ‡²ğŸ‡½</span>
        <div class="playa-nombre">CancÃºn</div>
        <div class="playa-pais">MÃ©xico</div>
        <div class="playa-temp">ğŸŒ¡ <span>26â€“30Â°C</span> &nbsp; ğŸ  <span>Arrecifes</span></div>
      </div>
    </div>

    <div class="playa-card" onclick="irADestino('San AndrÃ©s')">
      <img class="playa-img" src="https://images.unsplash.com/photo-1559494007-9f5847c49d94?w=400&q=80" alt="San AndrÃ©s" loading="lazy">
      <div class="playa-overlay">
        <span class="playa-badge">Isla ğŸ‡¨ğŸ‡´</span>
        <div class="playa-nombre">San AndrÃ©s</div>
        <div class="playa-pais">Colombia</div>
        <div class="playa-temp">ğŸŒ¡ <span>28â€“32Â°C</span> &nbsp; ğŸ¤¿ <span>Buceo</span></div>
      </div>
    </div>

    <div class="playa-card" onclick="irADestino('Aruba')">
      <img class="playa-img" src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=400&q=80" alt="Aruba" loading="lazy">
      <div class="playa-overlay">
        <span class="playa-badge">Caribe ğŸ‡¦ğŸ‡¼</span>
        <div class="playa-nombre">Aruba</div>
        <div class="playa-pais">Aruba, Caribe</div>
        <div class="playa-temp">ğŸŒ¡ <span>29â€“34Â°C</span> &nbsp; ğŸ„ <span>Surf</span></div>
      </div>
    </div>

    <div class="playa-card" onclick="irADestino('Miami Beach')">
      <img class="playa-img" src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&q=80" alt="Miami Beach" loading="lazy">
      <div class="playa-overlay">
        <span class="playa-badge">USA ğŸ‡ºğŸ‡¸</span>
        <div class="playa-nombre">Miami Beach</div>
        <div class="playa-pais">Florida, EE.UU.</div>
        <div class="playa-temp">ğŸŒ¡ <span>25â€“30Â°C</span> &nbsp; ğŸ‰ <span>Nightlife</span></div>
      </div>
    </div>
  </div>
</section>

<!-- ===== BANNER OFERTA ===== -->
<div style="padding: 0 40px 80px; max-width:1180px; margin:0 auto">
  <div class="oferta-banner">
    <img src="https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1200&q=80" alt="Oferta especial">
    <div class="oferta-content">
      <h3>Hasta 40% OFF en vuelos internacionales</h3>
      <p>Reserva antes del 30 de marzo y viaja al mejor precio del aÃ±o</p>
      <button class="btn-oferta" onclick="document.getElementById('destino').focus(); window.scrollTo({top:0,behavior:'smooth'})">Ver ofertas ahora â†’</button>
    </div>
  </div>
</div>

<!-- ===== PANEL ADMINISTRADOR ===== -->
<div class="admin-overlay" id="adminPanel">
  <div class="admin-panel">

    <!-- Login admin -->
    <div id="adminLoginView">
      <div class="admin-header">
        <h2>ğŸ›¡ï¸ Panel Administrador</h2>
        <button class="admin-close" onclick="closeAdmin()">Ã—</button>
      </div>
      <div class="admin-login">
        <h3>Acceso Administrador</h3>
        <input type="password" id="adminPwd" placeholder="ContraseÃ±a de admin" onkeydown="if(event.key==='Enter') adminLogin()">
        <button class="btn-admin-login" onclick="adminLogin()">ğŸ” Ingresar al panel</button>
      </div>
    </div>

    <!-- Panel admin autenticado -->
    <div id="adminMainView" style="display:none">
      <div class="admin-header">
        <div>
          <h2>ğŸ›¡ï¸ Panel AeroVuelos Admin</h2>
          <div style="font-size:12px;opacity:0.6;margin-top:2px">Control total Â· ActualizaciÃ³n en tiempo real</div>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <span class="badge">ADMIN</span>
          <button class="admin-close" onclick="closeAdmin()">Ã—</button>
        </div>
      </div>

      <!-- Stats -->
      <div style="padding:16px 24px 0">
        <div class="admin-stat-grid">
          <div class="admin-stat">
            <div class="num" id="statReservas">0</div>
            <div class="lbl">âœˆï¸ Reservas</div>
          </div>
          <div class="admin-stat">
            <div class="num" id="statUsuarios">0</div>
            <div class="lbl">ğŸ‘¤ Usuarios</div>
          </div>
          <div class="admin-stat">
            <div class="num" id="statIngresos">$0</div>
            <div class="lbl">ğŸ’° Ingresos est.</div>
          </div>
          <div class="admin-stat" style="grid-column:1/-1;border-color:rgba(37,211,102,0.3)">
            <div class="num" id="statPendientesWpp" style="color:#25d366;font-size:20px">0 nuevas</div>
            <div class="lbl">ğŸ“‹ Reservas sin enviar a WPP</div>
          </div>
        </div>

        <!-- Botones WPP admin -->
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px">
          <button onclick="enviarResumenWpp()" style="background:#25d366;color:white;border:none;padding:11px;border-radius:10px;font-weight:700;font-size:13px;cursor:pointer;font-family:'DM Sans',sans-serif">
            ğŸ“Š Resumen diario
          </button>
          <button onclick="enviarTodasPendientesWpp()" style="background:#128c7e;color:white;border:none;padding:11px;border-radius:10px;font-weight:700;font-size:13px;cursor:pointer;font-family:'DM Sans',sans-serif">
            ğŸ“² Ver reservas nuevas
          </button>
        </div>
      </div>

      <!-- Tabs -->
      <div class="admin-tabs">
        <div class="admin-tab active" onclick="adminTab(this,'tabReservas')">âœˆï¸ Reservas</div>
        <div class="admin-tab" onclick="adminTab(this,'tabUsuarios')">ğŸ‘¤ Usuarios</div>
        <div class="admin-tab" onclick="adminTab(this,'tabLog')">ğŸ“‹ Actividad</div>
      </div>

      <div class="admin-body">

        <!-- TAB RESERVAS -->
        <div class="tab-content active" id="tabReservas">
          <div id="listaReservas"><div id="adminNoData">Sin reservas aÃºn</div></div>
        </div>

        <!-- TAB USUARIOS -->
        <div class="tab-content" id="tabUsuarios">
          <div id="listaUsuarios"><div id="adminNoData">Sin usuarios registrados</div></div>
        </div>

        <!-- TAB LOG ACTIVIDAD -->
        <div class="tab-content" id="tabLog">
          <div id="listaLog"><div id="adminNoData">Sin actividad registrada</div></div>
        </div>

      </div>
    </div>

  </div>
</div>

<!-- =========== MODALES =========== -->

<!-- LOGIN -->
<div class="modal-overlay" id="loginModal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('loginModal')">Ã—</button>
    <h2>Iniciar sesiÃ³n</h2>
    <p class="subtitle">Bienvenido de vuelta, viajero</p>
    <div class="form-group">
      <label class="form-label">Correo electrÃ³nico</label>
      <input class="form-input" id="loginEmail" type="email" placeholder="tu@correo.com">
    </div>
    <div class="form-group">
      <label class="form-label">ContraseÃ±a</label>
      <input class="form-input" id="loginPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
    </div>
    <button class="btn-red" onclick="login()">Entrar a mi cuenta</button>
    <p class="switch-text">Â¿No tienes cuenta? <a onclick="switchModal('loginModal','registerModal')">RegÃ­strate gratis</a></p>
  </div>
</div>

<!-- REGISTRO -->
<div class="modal-overlay" id="registerModal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('registerModal')">Ã—</button>
    <h2>Crear cuenta</h2>
    <p class="subtitle">Ãšnete y empieza a volar</p>
    <div class="form-group">
      <label class="form-label">Nombre completo</label>
      <input class="form-input" id="regNombre" type="text" placeholder="Juan PÃ©rez">
    </div>
    <div class="form-group">
      <label class="form-label">Correo electrÃ³nico</label>
      <input class="form-input" id="regEmail" type="email" placeholder="tu@correo.com">
    </div>
    <div class="form-group">
      <label class="form-label">TelÃ©fono (WhatsApp)</label>
      <input class="form-input" id="regTel" type="tel" placeholder="+57 300 000 0000">
    </div>
    <div class="form-group">
      <label class="form-label">ContraseÃ±a</label>
      <input class="form-input" id="regPass" type="password" placeholder="MÃ­nimo 6 caracteres">
    </div>
    <button class="btn-red" onclick="register()">Crear mi cuenta</button>
    <p class="switch-text">Â¿Ya tienes cuenta? <a onclick="switchModal('registerModal','loginModal')">Inicia sesiÃ³n</a></p>
  </div>
</div>

<!-- RESULTADOS DE VUELOS -->
<div class="modal-overlay results-modal" id="resultsModal">
  <div class="modal" style="max-width:640px">
    <button class="modal-close" onclick="closeModal('resultsModal')">Ã—</button>
    <h2>Vuelos disponibles</h2>
    <p class="subtitle" id="resultsSubtitle">Selecciona tu vuelo</p>
    <div id="flightsList"></div>
    <button class="btn-red" id="btnSelectFlight" style="display:none" onclick="openPayment()">Continuar con este vuelo â†’</button>
  </div>
</div>

<!-- PAGO -->
<div class="modal-overlay" id="paymentModal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('paymentModal')">Ã—</button>
    <h2>Pagar reserva</h2>
    <p class="subtitle">Transfiere y confirma tu reserva</p>

    <div class="price-summary">
      <div class="price-row"><span>Tiquete base</span><span id="precioBase">$0</span></div>
      <div class="price-row"><span>Tasas y cargos</span><span id="precioTasas">$0</span></div>
      <div class="price-row total"><span>ğŸ’° Total a pagar</span><span id="precioTotal">$0</span></div>
    </div>

    <!-- Solo Llave Bred Bancolombia -->
    <div class="info-box" style="background:#fff3e0;border-color:#ffb74d;margin-bottom:20px">
      <strong style="color:#e65100;font-size:14px">ğŸ¦ Pago por Llave Bred â€” Bancolombia</strong>
      <div style="margin-top:10px;display:grid;gap:6px">
        <div style="display:flex;justify-content:space-between;font-size:13px">
          <span style="color:#666">Llave Bred:</span>
          <strong id="showBred" style="color:#e65100;font-size:16px;letter-spacing:1px">1005753450</strong>
        </div>
        <div style="display:flex;justify-content:space-between;font-size:13px">
          <span style="color:#666">Beneficiario:</span>
          <strong>AeroVuelos Colombia</strong>
        </div>
        <div style="display:flex;justify-content:space-between;font-size:13px">
          <span style="color:#666">Tipo de cuenta:</span>
          <strong>Ahorros Bancolombia</strong>
        </div>
        <div style="display:flex;justify-content:space-between;font-size:13px">
          <span style="color:#666">Banco:</span>
          <strong>Bancolombia</strong>
        </div>
      </div>
      <div style="margin-top:10px;padding:8px 12px;background:rgba(230,81,0,0.08);border-radius:8px;font-size:12px;color:#bf360c">
        âš ï¸ Escribe en el concepto tu <b>nombre completo + cÃ³digo de reserva</b><br>
        Una vez realizado el pago, sube el nÃºmero de comprobante abajo.
      </div>
    </div>

    <div class="form-group">
      <label class="form-label">Nombre del pasajero (titular)</label>
      <input class="form-input" id="pagNombre" type="text" placeholder="Como aparece en el documento">
    </div>
    <div class="form-group">
      <label class="form-label">NÃºmero de documento</label>
      <input class="form-input" id="pagDoc" type="text" placeholder="CÃ©dula o pasaporte">
    </div>
    <div class="form-group">
      <label class="form-label">NÂ° de comprobante de pago <span style="color:var(--red)">*</span></label>
      <input class="form-input" id="pagComprobante" type="text" placeholder="NÃºmero de transacciÃ³n Bancolombia">
    </div>

    <button class="btn-red" onclick="confirmarPago()">âœ… Confirmar reserva y pago</button>
    <p style="text-align:center;font-size:12px;color:var(--muted);margin-top:10px">
      Al confirmar, tu reserva llegarÃ¡ al administrador por WhatsApp para verificaciÃ³n.
    </p>
  </div>
</div>

<!-- TIQUETE / COMPROBANTE -->
<div class="modal-overlay ticket-modal" id="ticketModal">
  <div class="modal" style="max-width:560px;padding:0;overflow:hidden;border-radius:16px">
    <button class="modal-close" onclick="closeModal('ticketModal')" style="top:12px;right:12px;z-index:10">Ã—</button>

    <!-- Header del tiquete -->
    <div class="ticket-header">
      <div>
        <div class="airline">âœˆ AeroVuelos</div>
        <div style="font-size:12px;opacity:0.8;margin-top:4px">Comprobante de reserva</div>
      </div>
      <div style="text-align:right">
        <div class="code-label">CÃ³digo de reserva</div>
        <div class="code-val" id="tktCodigo">â€”</div>
      </div>
    </div>

    <!-- Cuerpo del tiquete -->
    <div class="ticket-body">

      <!-- Ruta -->
      <div class="ticket-route">
        <div class="ticket-city">
          <div class="iata" id="tktOrigen">BOG</div>
          <div class="name" id="tktOrigenNombre">BogotÃ¡</div>
        </div>
        <div style="flex:1;text-align:center">
          <div class="ticket-arrow">âœˆ</div>
          <div style="font-size:11px;color:var(--muted)" id="tktDuracion">â€”</div>
        </div>
        <div class="ticket-city">
          <div class="iata" id="tktDestino">â€”</div>
          <div class="name" id="tktDestinoNombre">Destino</div>
        </div>
      </div>

      <!-- Campos principales -->
      <div class="ticket-grid">
        <div class="ticket-field">
          <div class="t-label">Pasajero</div>
          <div class="t-val" id="tktPasajero">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Documento</div>
          <div class="t-val" id="tktDoc">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Aeropuerto de salida</div>
          <div class="t-val" id="tktAptOrigen" style="font-size:12px">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Terminal salida</div>
          <div class="t-val" id="tktTermOrigen" style="font-size:12px">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Aeropuerto de llegada</div>
          <div class="t-val" id="tktAptDestino" style="font-size:12px">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Terminal llegada</div>
          <div class="t-val" id="tktTermDestino" style="font-size:12px">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Fecha de vuelo</div>
          <div class="t-val" id="tktFecha">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Hora de salida</div>
          <div class="t-val" id="tktHora">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Llegada</div>
          <div class="t-val" id="tktLlegada">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">AerolÃ­nea</div>
          <div class="t-val" id="tktAerolinea">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Asiento</div>
          <div class="t-val" id="tktAsiento">â€”</div>
        </div>
        <div class="ticket-field">
          <div class="t-label">Cabina</div>
          <div class="t-val" id="tktCabina">â€”</div>
        </div>
      </div>

      <hr class="ticket-divider">

      <!-- Equipaje y servicios -->
      <div class="ticket-extras">
        <h4>ğŸ§³ Equipaje y servicios incluidos</h4>
        <div class="extras-row"><span>Equipaje de mano</span><span id="tktHandbag">10 kg</span></div>
        <div class="extras-row"><span>Maleta en bodega</span><span id="tktBaggage">â€”</span></div>
        <div class="extras-row"><span>MÃ©todo de pago</span><span id="tktMetodoPago">â€”</span></div>
        <div class="extras-row"><span>Total pagado</span><span id="tktTotal" style="color:var(--red)">â€”</span></div>
      </div>

      <!-- Condiciones especiales -->
      <div class="ticket-conditions">
        <strong>ğŸ“‹ Condiciones especiales</strong>
        <span id="tktCondiciones">â€”</span>
      </div>

      <!-- Botones -->
      <div class="ticket-actions">
        <button class="btn-download" onclick="descargarTiquetePDF()">â¬‡ï¸ Descargar PDF</button>
        <button class="btn-share" onclick="compartirWhatsApp()">ğŸ“² Enviar por WhatsApp</button>
      </div>

      <p style="text-align:center;font-size:11px;color:var(--muted);margin-top:12px">
        ğŸ“§ Tu reserva tambiÃ©n fue enviada a tu correo y notificada por Telegram.
      </p>
    </div>
  </div>
</div>

<!-- Ãrea de impresiÃ³n/PDF -->
<div id="ticketPrintArea"></div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
// ===== CONFIG - PERSONALIZA AQUÃ =====
const CONFIG = {
  // â”€â”€ ADMIN WhatsApp â€” aquÃ­ llegan TODOS los movimientos â”€â”€
  adminWpp: '573018614849',
  adminPassword: 'admin123',
  // â”€â”€ PAGO: Solo Llave Bred (Bancolombia) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  bredNombre:  'AeroVuelos Colombia',
  bredLlave:   '1005753450',
  bredTipoCta: 'Ahorros Bancolombia',
  wppContacto: '3018614849',
};

// ===== DATOS =====
let currentTab = 'idaVuelta';
let selectedFlight = null;
let selectedPayMethod = null;
let currentUser = null;
let reservationCode = '';
let lastReserva = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// VUELOS REALES â€” Precios competitivos (referencia Avianca 2025)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const vuelosMock = [
  // BOG â†’ MED
  { id:1,  origen:'BOG', destino:'MED', hora:'05:45', llegada:'06:55', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV101', precio:189900, tasas:36000 },
  { id:2,  origen:'BOG', destino:'MED', hora:'09:10', llegada:'10:20', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV103', precio:245000, tasas:36000 },
  { id:3,  origen:'BOG', destino:'MED', hora:'14:30', llegada:'15:40', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV105', precio:198000, tasas:36000 },
  { id:4,  origen:'BOG', destino:'MED', hora:'18:50', llegada:'20:00', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV107', precio:229000, tasas:36000 },
  // BOG â†’ CTG
  { id:5,  origen:'BOG', destino:'CTG', hora:'06:30', llegada:'07:45', duracion:'1h 15m', aerolinea:'AeroVuelos', vuelo:'AV201', precio:319000, tasas:52000 },
  { id:6,  origen:'BOG', destino:'CTG', hora:'11:20', llegada:'12:35', duracion:'1h 15m', aerolinea:'AeroVuelos', vuelo:'AV203', precio:358000, tasas:52000 },
  { id:7,  origen:'BOG', destino:'CTG', hora:'17:00', llegada:'18:15', duracion:'1h 15m', aerolinea:'AeroVuelos', vuelo:'AV205', precio:289000, tasas:52000 },
  // BOG â†’ CLO
  { id:8,  origen:'BOG', destino:'CLO', hora:'07:00', llegada:'07:55', duracion:'55m',    aerolinea:'AeroVuelos', vuelo:'AV301', precio:178000, tasas:31000 },
  { id:9,  origen:'BOG', destino:'CLO', hora:'12:30', llegada:'13:25', duracion:'55m',    aerolinea:'AeroVuelos', vuelo:'AV303', precio:215000, tasas:31000 },
  { id:10, origen:'BOG', destino:'CLO', hora:'19:10', llegada:'20:05', duracion:'55m',    aerolinea:'AeroVuelos', vuelo:'AV305', precio:199000, tasas:31000 },
  // BOG â†’ BAQ
  { id:11, origen:'BOG', destino:'BAQ', hora:'07:50', llegada:'09:00', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV401', precio:259000, tasas:42000 },
  { id:12, origen:'BOG', destino:'BAQ', hora:'14:00', llegada:'15:10', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV403', precio:289000, tasas:42000 },
  // BOG â†’ ADZ
  { id:13, origen:'BOG', destino:'ADZ', hora:'06:00', llegada:'07:25', duracion:'1h 25m', aerolinea:'AeroVuelos', vuelo:'AV501', precio:428000, tasas:58000 },
  { id:14, origen:'BOG', destino:'ADZ', hora:'11:30', llegada:'12:55', duracion:'1h 25m', aerolinea:'AeroVuelos', vuelo:'AV503', precio:479000, tasas:58000 },
  // BOG â†’ SMR
  { id:15, origen:'BOG', destino:'SMR', hora:'07:15', llegada:'08:25', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV601', precio:272000, tasas:44000 },
  { id:16, origen:'BOG', destino:'SMR', hora:'15:40', llegada:'16:50', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV603', precio:298000, tasas:44000 },
  // BOG â†’ PEI
  { id:17, origen:'BOG', destino:'PEI', hora:'08:00', llegada:'08:50', duracion:'50m',    aerolinea:'AeroVuelos', vuelo:'AV701', precio:169000, tasas:29000 },
  { id:18, origen:'BOG', destino:'PEI', hora:'15:20', llegada:'16:10', duracion:'50m',    aerolinea:'AeroVuelos', vuelo:'AV703', precio:195000, tasas:29000 },
  // BOG â†’ BGA
  { id:19, origen:'BOG', destino:'BGA', hora:'06:10', llegada:'07:05', duracion:'55m',    aerolinea:'AeroVuelos', vuelo:'AV801', precio:172000, tasas:29000 },
  { id:20, origen:'BOG', destino:'BGA', hora:'13:00', llegada:'13:55', duracion:'55m',    aerolinea:'AeroVuelos', vuelo:'AV803', precio:199000, tasas:29000 },
  // BOG â†’ CUC
  { id:21, origen:'BOG', destino:'CUC', hora:'09:30', llegada:'10:30', duracion:'1h',     aerolinea:'AeroVuelos', vuelo:'AV851', precio:215000, tasas:34000 },

  // MED â†’ BOG
  { id:22, origen:'MED', destino:'BOG', hora:'07:30', llegada:'08:40', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV102', precio:189900, tasas:36000 },
  { id:23, origen:'MED', destino:'BOG', hora:'12:10', llegada:'13:20', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV104', precio:215000, tasas:36000 },
  { id:24, origen:'MED', destino:'BOG', hora:'17:30', llegada:'18:40', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV106', precio:199000, tasas:36000 },
  // MED â†’ CTG
  { id:25, origen:'MED', destino:'CTG', hora:'09:00', llegada:'10:05', duracion:'1h 05m', aerolinea:'AeroVuelos', vuelo:'AV211', precio:289000, tasas:48000 },
  { id:26, origen:'MED', destino:'CTG', hora:'16:30', llegada:'17:35', duracion:'1h 05m', aerolinea:'AeroVuelos', vuelo:'AV213', precio:315000, tasas:48000 },
  // MED â†’ CLO
  { id:27, origen:'MED', destino:'CLO', hora:'08:15', llegada:'09:05', duracion:'50m',    aerolinea:'AeroVuelos', vuelo:'AV311', precio:168000, tasas:29000 },
  { id:28, origen:'MED', destino:'CLO', hora:'14:40', llegada:'15:30', duracion:'50m',    aerolinea:'AeroVuelos', vuelo:'AV313', precio:189000, tasas:29000 },
  // MED â†’ BAQ
  { id:29, origen:'MED', destino:'BAQ', hora:'10:00', llegada:'11:05', duracion:'1h 05m', aerolinea:'AeroVuelos', vuelo:'AV411', precio:245000, tasas:40000 },
  // MED â†’ ADZ
  { id:30, origen:'MED', destino:'ADZ', hora:'07:00', llegada:'08:20', duracion:'1h 20m', aerolinea:'AeroVuelos', vuelo:'AV511', precio:399000, tasas:55000 },
  // MED â†’ SMR
  { id:31, origen:'MED', destino:'SMR', hora:'13:10', llegada:'14:15', duracion:'1h 05m', aerolinea:'AeroVuelos', vuelo:'AV611', precio:258000, tasas:42000 },
  // MED â†’ PEI
  { id:32, origen:'MED', destino:'PEI', hora:'08:30', llegada:'09:15', duracion:'45m',    aerolinea:'AeroVuelos', vuelo:'AV711', precio:148000, tasas:25000 },
  { id:33, origen:'MED', destino:'PEI', hora:'15:00', llegada:'15:45', duracion:'45m',    aerolinea:'AeroVuelos', vuelo:'AV713', precio:168000, tasas:25000 },
  // MED â†’ BGA
  { id:34, origen:'MED', destino:'BGA', hora:'12:30', llegada:'13:25', duracion:'55m',    aerolinea:'AeroVuelos', vuelo:'AV812', precio:185000, tasas:31000 },

  // PEI â†’ BOG
  { id:35, origen:'PEI', destino:'BOG', hora:'07:00', llegada:'07:50', duracion:'50m',    aerolinea:'AeroVuelos', vuelo:'AV702', precio:169000, tasas:29000 },
  { id:36, origen:'PEI', destino:'BOG', hora:'16:30', llegada:'17:20', duracion:'50m',    aerolinea:'AeroVuelos', vuelo:'AV704', precio:192000, tasas:29000 },
  // PEI â†’ MED
  { id:37, origen:'PEI', destino:'MED', hora:'08:30', llegada:'09:15', duracion:'45m',    aerolinea:'AeroVuelos', vuelo:'AV712', precio:148000, tasas:25000 },
  { id:38, origen:'PEI', destino:'MED', hora:'14:00', llegada:'14:45', duracion:'45m',    aerolinea:'AeroVuelos', vuelo:'AV714', precio:168000, tasas:25000 },
  // PEI â†’ CTG
  { id:39, origen:'PEI', destino:'CTG', hora:'11:20', llegada:'12:35', duracion:'1h 15m', aerolinea:'AeroVuelos', vuelo:'AV721', precio:268000, tasas:44000 },
  // PEI â†’ CLO
  { id:40, origen:'PEI', destino:'CLO', hora:'09:10', llegada:'09:55', duracion:'45m',    aerolinea:'AeroVuelos', vuelo:'AV731', precio:145000, tasas:25000 },

  // CTG â†’ BOG
  { id:41, origen:'CTG', destino:'BOG', hora:'08:30', llegada:'09:45', duracion:'1h 15m', aerolinea:'AeroVuelos', vuelo:'AV202', precio:319000, tasas:52000 },
  { id:42, origen:'CTG', destino:'BOG', hora:'19:00', llegada:'20:15', duracion:'1h 15m', aerolinea:'AeroVuelos', vuelo:'AV206', precio:289000, tasas:52000 },
  // CTG â†’ MED
  { id:43, origen:'CTG', destino:'MED', hora:'11:00', llegada:'12:05', duracion:'1h 05m', aerolinea:'AeroVuelos', vuelo:'AV212', precio:289000, tasas:48000 },
  // CTG â†’ BAQ
  { id:44, origen:'CTG', destino:'BAQ', hora:'13:00', llegada:'13:45', duracion:'45m',    aerolinea:'AeroVuelos', vuelo:'AV422', precio:145000, tasas:25000 },

  // CLO â†’ BOG
  { id:45, origen:'CLO', destino:'BOG', hora:'08:00', llegada:'08:55', duracion:'55m',    aerolinea:'AeroVuelos', vuelo:'AV302', precio:178000, tasas:31000 },
  { id:46, origen:'CLO', destino:'BOG', hora:'17:30', llegada:'18:25', duracion:'55m',    aerolinea:'AeroVuelos', vuelo:'AV304', precio:199000, tasas:31000 },
  // CLO â†’ MED
  { id:47, origen:'CLO', destino:'MED', hora:'10:00', llegada:'10:50', duracion:'50m',    aerolinea:'AeroVuelos', vuelo:'AV312', precio:168000, tasas:29000 },
  // CLO â†’ CTG
  { id:48, origen:'CLO', destino:'CTG', hora:'13:30', llegada:'14:45', duracion:'1h 15m', aerolinea:'AeroVuelos', vuelo:'AV322', precio:289000, tasas:48000 },

  // BAQ â†’ BOG
  { id:49, origen:'BAQ', destino:'BOG', hora:'10:00', llegada:'11:10', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV402', precio:259000, tasas:42000 },
  { id:50, origen:'BAQ', destino:'BOG', hora:'17:30', llegada:'18:40', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV404', precio:279000, tasas:42000 },
  // BAQ â†’ MED
  { id:51, origen:'BAQ', destino:'MED', hora:'12:00', llegada:'13:05', duracion:'1h 05m', aerolinea:'AeroVuelos', vuelo:'AV412', precio:245000, tasas:40000 },
  // BAQ â†’ CTG
  { id:52, origen:'BAQ', destino:'CTG', hora:'08:30', llegada:'09:15', duracion:'45m',    aerolinea:'AeroVuelos', vuelo:'AV423', precio:145000, tasas:25000 },

  // BGA â†’ BOG
  { id:53, origen:'BGA', destino:'BOG', hora:'07:45', llegada:'08:40', duracion:'55m',    aerolinea:'AeroVuelos', vuelo:'AV802', precio:172000, tasas:29000 },
  // ADZ â†’ BOG
  { id:54, origen:'ADZ', destino:'BOG', hora:'09:30', llegada:'10:55', duracion:'1h 25m', aerolinea:'AeroVuelos', vuelo:'AV502', precio:428000, tasas:58000 },
  // SMR â†’ BOG
  { id:55, origen:'SMR', destino:'BOG', hora:'09:30', llegada:'10:40', duracion:'1h 10m', aerolinea:'AeroVuelos', vuelo:'AV602', precio:272000, tasas:44000 },

  // INTERNACIONALES desde BOG
  { id:56, origen:'BOG', destino:'MIA', hora:'10:35', llegada:'14:55', duracion:'4h 20m', aerolinea:'AeroVuelos', vuelo:'AV901', precio:1289000, tasas:198000 },
  { id:57, origen:'BOG', destino:'MIA', hora:'22:15', llegada:'02:35+1',duracion:'4h 20m',aerolinea:'AeroVuelos', vuelo:'AV903', precio:1099000, tasas:198000 },
  { id:58, origen:'BOG', destino:'JFK', hora:'08:05', llegada:'16:20', duracion:'8h 15m', aerolinea:'AeroVuelos', vuelo:'AV911', precio:1889000, tasas:245000 },
  { id:59, origen:'BOG', destino:'MAD', hora:'21:55', llegada:'14:20+1',duracion:'10h 25m',aerolinea:'AeroVuelos',vuelo:'AV951',precio:2899000, tasas:395000 },
  { id:60, origen:'BOG', destino:'LIM', hora:'07:20', llegada:'09:50', duracion:'2h 30m', aerolinea:'AeroVuelos', vuelo:'AV961', precio:689000,  tasas:98000  },
  { id:61, origen:'BOG', destino:'PTY', hora:'06:25', llegada:'07:45', duracion:'1h 20m', aerolinea:'AeroVuelos', vuelo:'AV971', precio:598000,  tasas:82000  },
  { id:62, origen:'BOG', destino:'CUN', hora:'09:15', llegada:'12:35', duracion:'3h 20m', aerolinea:'AeroVuelos', vuelo:'AV981', precio:989000,  tasas:135000 },
  { id:63, origen:'BOG', destino:'GRU', hora:'23:30', llegada:'07:00+1',duracion:'7h 30m',aerolinea:'AeroVuelos', vuelo:'AV991', precio:1450000, tasas:185000 },
  { id:64, origen:'BOG', destino:'EZE', hora:'22:00', llegada:'08:30+1',duracion:'10h 30m',aerolinea:'AeroVuelos',vuelo:'AV993',precio:1650000, tasas:210000 },
  { id:65, origen:'BOG', destino:'SCL', hora:'20:45', llegada:'06:15+1',duracion:'9h 30m',aerolinea:'AeroVuelos', vuelo:'AV995', precio:1550000, tasas:200000 },
  { id:66, origen:'BOG', destino:'UIO', hora:'10:00', llegada:'11:30', duracion:'1h 30m', aerolinea:'AeroVuelos', vuelo:'AV997', precio:485000,  tasas:68000  },
  // INTERNACIONALES desde MED
  { id:67, origen:'MED', destino:'MIA', hora:'12:40', llegada:'16:55', duracion:'4h 15m', aerolinea:'AeroVuelos', vuelo:'AV902', precio:1289000, tasas:198000 },
  { id:68, origen:'MED', destino:'MAD', hora:'22:30', llegada:'15:00+1',duracion:'10h 30m',aerolinea:'AeroVuelos',vuelo:'AV952',precio:2899000, tasas:395000 },
  { id:69, origen:'MED', destino:'PTY', hora:'08:00', llegada:'09:20', duracion:'1h 20m', aerolinea:'AeroVuelos', vuelo:'AV972', precio:598000,  tasas:82000  },
];

function formatCOP(n) {
  return '$' + n.toLocaleString('es-CO');
}

function genCode() {
  return 'AV' + Math.random().toString(36).substr(2,6).toUpperCase();
}

// ===== TABS =====
function setTab(btn, tab) {
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  currentTab = tab;
  document.getElementById('fechaVueltaGroup').style.display = tab === 'soloIda' ? 'none' : '';
}

// ===== MODALES =====
function openModal(id) {
  document.getElementById(id).classList.add('active');
}
function closeModal(id) {
  document.getElementById(id).classList.remove('active');
}
function switchModal(close, open) {
  closeModal(close); openModal(open);
}

// ===== TOAST =====
function showToast(msg, type='') {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className = 'toast show ' + type;
  setTimeout(() => t.classList.remove('show'), 3500);
}

// ===== WHATSAPP ADMIN â€” Panel de control =====
// Guarda el mensaje internamente y lo envÃ­a de forma invisible al admin
function sendAdminWpp(mensaje) {
  // Guardar en cola de mensajes pendientes para admin
  const cola = JSON.parse(localStorage.getItem('av_wpp_cola') || '[]');
  cola.unshift({ mensaje, fecha: new Date().toLocaleString('es-CO'), enviado: false });
  if (cola.length > 50) cola.splice(50);
  localStorage.setItem('av_wpp_cola', JSON.stringify(cola));
  // Notificar al admin sin interrumpir al cliente
  // (El admin puede ver y enviar desde el panel admin)
}

// ===== TELEGRAM ADMIN NOTIFICATION =====
function enviarTelegram(mensaje) {
  const TOKEN = '8483671242:AAERb0vkoBT4ugrriiTwLMFnbukHkIgk7co';
  const CHAT_ID = '8114050673';
  fetch('https://api.telegram.org/bot' + TOKEN + '/sendMessage', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      chat_id: CHAT_ID,
      text: mensaje,
      parse_mode: 'Markdown'
    })
  }).catch(function(){});
}

// Esta funciÃ³n SÃ abre WhatsApp â€” solo la usa el admin desde su panel
function abrirWppAdmin(mensaje) {
  const url = `https://wa.me/${CONFIG.adminWpp}?text=${encodeURIComponent(mensaje)}`;
  window.open(url, '_blank');
}

// VersiÃ³n silenciosa: guarda en localStorage para el historial admin
function logAdminEvent(tipo, datos) {
  const eventos = JSON.parse(localStorage.getItem('av_admin_log') || '[]');
  eventos.unshift({
    tipo,
    datos,
    fecha: new Date().toLocaleString('es-CO'),
    id: 'EVT' + Date.now()
  });
  // MÃ¡ximo 200 eventos en log
  if (eventos.length > 200) eventos.splice(200);
  localStorage.setItem('av_admin_log', JSON.stringify(eventos));
}

// ===== REGISTRO =====
function register() {
  const nombre = document.getElementById('regNombre').value.trim();
  const email  = document.getElementById('regEmail').value.trim();
  const tel    = document.getElementById('regTel').value.trim();
  const pass   = document.getElementById('regPass').value;

  if (!nombre || !email || !tel || !pass) {
    showToast('âš ï¸ Completa todos los campos', 'error'); return;
  }
  if (pass.length < 6) {
    showToast('âš ï¸ La contraseÃ±a debe tener al menos 6 caracteres', 'error'); return;
  }

  // Guardar usuario (localStorage para demo)
  const users = JSON.parse(localStorage.getItem('av_users') || '[]');
  if (users.find(u => u.email === email)) {
    showToast('âš ï¸ Este correo ya estÃ¡ registrado', 'error'); return;
  }
  users.push({ nombre, email, tel, pass });
  localStorage.setItem('av_users', JSON.stringify(users));

  currentUser = { nombre, email, tel };
  localStorage.setItem('av_currentUser', JSON.stringify(currentUser));

  // Log admin
  logAdminEvent('NUEVO_REGISTRO', { nombre, email, tel, fecha: new Date().toLocaleString('es-CO') });

  closeModal('registerModal');
  showToast(`âœ… Bienvenido ${nombre}!`, 'success');
  updateNavUser();
}

// ===== LOGIN =====
function login() {
  const email = document.getElementById('loginEmail').value.trim();
  const pass  = document.getElementById('loginPass').value;

  // Admin check
  if (email === 'admin' && pass === CONFIG.adminPassword) {
    window.location.href = 'admin.html';
    return;
  }

  const users = JSON.parse(localStorage.getItem('av_users') || '[]');
  const user = users.find(u => u.email === email && u.pass === pass);

  if (!user) {
    showToast('âš ï¸ Correo o contraseÃ±a incorrectos', 'error'); return;
  }

  currentUser = { nombre: user.nombre, email: user.email, tel: user.tel };
  localStorage.setItem('av_currentUser', JSON.stringify(currentUser));

  closeModal('loginModal');
  showToast(`âœ… Hola ${user.nombre}!`, 'success');
  updateNavUser();
}

function updateNavUser() {
  const u = currentUser || JSON.parse(localStorage.getItem('av_currentUser') || 'null');
  if (u) {
    document.querySelector('.nav-buttons').innerHTML = `
      <span style="color:white;font-size:14px">Hola, ${u.nombre.split(' ')[0]}</span>
      <button class="btn-outline" onclick="logout()">Salir</button>
    `;
  }
}

function logout() {
  localStorage.removeItem('av_currentUser');
  location.reload();
}

// ===== BUSCAR VUELOS â€” FILTRO REAL =====
function buscarVuelos() {
  const origenRaw  = document.getElementById('origen').value.trim().toUpperCase();
  const destinoRaw = document.getElementById('destino').value.trim().toUpperCase();
  const fechaIda   = document.getElementById('fechaIda').value;

  if (!destinoRaw) { showToast('âš ï¸ Ingresa el destino', 'error'); return; }
  if (!fechaIda)   { showToast('âš ï¸ Selecciona la fecha de ida', 'error'); return; }

  // Log de bÃºsqueda al admin
  logAdminEvent('BUSQUEDA', { origen: origenRaw, destino: destinoRaw, fecha: fechaIda });

  // FunciÃ³n que convierte texto a cÃ³digo IATA (acepta nombre o IATA directo)
  function resolverIATA(texto) {
    if (!texto) return null;
    // Si ya es IATA vÃ¡lido (3 letras)
    if (AEROPUERTOS[texto]) return texto;
    // Buscar por nombre de ciudad
    for (const [iata, data] of Object.entries(AEROPUERTOS)) {
      if (data.ciudad.toUpperCase().includes(texto) ||
          data.aeropuerto.toUpperCase().includes(texto)) {
        return iata;
      }
    }
    // Mapeo de nombres comunes colombianos
    const alias = {
      'BOGOTA':'BOG','BOGOTÃ':'BOG','EL DORADO':'BOG',
      'MEDELLIN':'MED','MEDELLÃN':'MED','CORDOBA':'MED','CÃ“RDOVA':'MED','JOSE CORDOVA':'MED',
      'CALI':'CLO','BONILLA':'CLO',
      'CARTAGENA':'CTG','NUNEZ':'CTG','NÃšÃ‘EZ':'CTG',
      'BARRANQUILLA':'BAQ','CORTISSOZ':'BAQ',
      'PEREIRA':'PEI','MATECANA':'PEI','MATECAÃ‘A':'PEI',
      'BUCARAMANGA':'BGA','PALONEGRO':'BGA',
      'SANTA MARTA':'SMR','SIMON BOLIVAR':'SMR','SIMÃ“N BOLÃVAR':'SMR',
      'SAN ANDRES':'ADZ','SAN ANDRÃ‰S':'ADZ','GUSTAVO ROJAS':'ADZ',
      'CUCUTA':'CUC','CÃšCUTA':'CUC','CAMILO DAZA':'CUC',
      'MIAMI':'MIA','NUEVA YORK':'JFK','NEW YORK':'JFK',
      'MADRID':'MAD','BARAJAS':'MAD',
      'LIMA':'LIM','JORGE CHAVEZ':'LIM','JORGE CHÃVEZ':'LIM',
      'PANAMA':'PTY','PANAMÃ':'PTY','TOCUMEN':'PTY',
      'CANCUN':'CUN','CANCÃšN':'CUN',
      'SAO PAULO':'GRU','SÃƒO PAULO':'GRU','GUARULHOS':'GRU',
      'BUENOS AIRES':'EZE','EZEIZA':'EZE',
      'SANTIAGO':'SCL','MERINO':'SCL',
      'QUITO':'UIO','MARISCAL SUCRE':'UIO',
    };
    for (const [key, iata] of Object.entries(alias)) {
      if (texto.includes(key) || key.includes(texto)) return iata;
    }
    return texto; // devuelve el texto para comparaciÃ³n directa
  }

  const origenIATA  = resolverIATA(origenRaw)  || origenRaw;
  const destinoIATA = resolverIATA(destinoRaw) || destinoRaw;

  // Filtrar vuelos que coincidan
  let resultados = vuelosMock.filter(v => {
    const matchOrigen = !origenRaw ||
      v.origen === origenIATA ||
      v.origen.includes(origenIATA) ||
      AEROPUERTOS[v.origen]?.ciudad.toUpperCase().includes(origenRaw);

    const matchDestino =
      v.destino === destinoIATA ||
      v.destino.includes(destinoIATA) ||
      AEROPUERTOS[v.destino]?.ciudad.toUpperCase().includes(destinoRaw);

    return matchOrigen && matchDestino;
  });

  const lista = document.getElementById('flightsList');
  lista.innerHTML = '';
  selectedFlight = null;
  document.getElementById('btnSelectFlight').style.display = 'none';

  const origenNombre  = AEROPUERTOS[origenIATA]?.ciudad  || origenIATA;
  const destinoNombre = AEROPUERTOS[destinoIATA]?.ciudad || destinoIATA;
  document.getElementById('resultsSubtitle').textContent =
    `${origenNombre} (${origenIATA}) â†’ ${destinoNombre} (${destinoIATA})  Â·  ${formatFecha(fechaIda)}`;

  if (resultados.length === 0) {
    lista.innerHTML = `
      <div style="text-align:center;padding:40px 20px;color:var(--muted)">
        <div style="font-size:40px;margin-bottom:12px">âœˆï¸</div>
        <div style="font-size:16px;font-weight:600;margin-bottom:8px">No encontramos vuelos disponibles</div>
        <div style="font-size:13px">Para la ruta <b>${origenNombre} â†’ ${destinoNombre}</b><br>
        Intenta con otra fecha o verifica los nombres de las ciudades.</div>
        <div style="margin-top:16px;font-size:12px;color:#aaa">Ciudades disponibles: BogotÃ¡, MedellÃ­n, Cali, Cartagena, Barranquilla, Pereira, Santa Marta, San AndrÃ©s, Bucaramanga, CÃºcuta, Miami, Nueva York, Madrid, Lima, PanamÃ¡, CancÃºn y mÃ¡s.</div>
      </div>`;
  } else {
    resultados.forEach(v => {
      const aptO = getInfoAeropuerto(v.origen);
      const aptD = getInfoAeropuerto(v.destino);
      const card = document.createElement('div');
      card.className = 'flight-card';
      card.innerHTML = `
        <div class="flight-header">
          <div>
            <span class="flight-route">${v.origen} â†’ ${v.destino}</span>
            <div style="font-size:11px;color:var(--muted);margin-top:2px">${aptO.ciudad} â†’ ${aptD.ciudad}</div>
          </div>
          <span class="flight-price">${formatCOP(v.precio)}</span>
        </div>
        <div class="flight-details">
          ğŸ• ${v.hora} â†’ ${v.llegada} &nbsp;|&nbsp; â± ${v.duracion} &nbsp;|&nbsp; âœˆï¸ ${v.vuelo}
        </div>
        <div style="font-size:11px;color:var(--muted);margin-top:4px">
          ğŸ›« ${aptO.aeropuerto} &nbsp;â†’&nbsp; ğŸ›¬ ${aptD.aeropuerto}
        </div>
      `;
      card.onclick = () => {
        document.querySelectorAll('.flight-card').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        selectedFlight = v;
        document.getElementById('btnSelectFlight').style.display = 'block';
      };
      lista.appendChild(card);
    });
  }

  openModal('resultsModal');
}

// ===== PAGO =====
function openPayment() {
  if (!currentUser && !JSON.parse(localStorage.getItem('av_currentUser') || 'null')) {
    closeModal('resultsModal');
    showToast('âš ï¸ Debes iniciar sesiÃ³n para reservar', 'error');
    setTimeout(() => openModal('loginModal'), 800);
    return;
  }
  closeModal('resultsModal');

  document.getElementById('precioBase').textContent = formatCOP(selectedFlight.precio);
  document.getElementById('precioTasas').textContent = formatCOP(selectedFlight.tasas);
  document.getElementById('precioTotal').textContent = formatCOP(selectedFlight.precio + selectedFlight.tasas);

  openModal('paymentModal');
}

function selectPayment(method, el) {
  // Solo Llave Bred â€” esta funciÃ³n queda por compatibilidad
  selectedPayMethod = 'bred';
}

async function confirmarPago() {
  const nombre      = document.getElementById('pagNombre').value.trim();
  const doc         = document.getElementById('pagDoc').value.trim();
  const comprobante = document.getElementById('pagComprobante').value.trim();

  if (!nombre || !doc) { showToast('âš ï¸ Completa nombre y documento', 'error'); return; }
  selectedPayMethod = 'bred'; // Solo Llave Bred

  const user = currentUser || JSON.parse(localStorage.getItem('av_currentUser') || '{}');
  reservationCode = genCode();
  const total = selectedFlight.precio + selectedFlight.tasas;

  // Asiento aleatorio
  const asiento = generarAsiento(document.getElementById('cabina').value);

  // Condiciones segÃºn cabina
  const condiciones = getCondiciones(document.getElementById('cabina').value, selectedPayMethod);

  // Equipaje segÃºn cabina
  const equipaje = getEquipaje(document.getElementById('cabina').value);

  // Guardar reserva
  const reservas = JSON.parse(localStorage.getItem('av_reservas') || '[]');
  const reserva = {
    codigo: reservationCode,
    usuario: user,
    vuelo: selectedFlight,
    pasajero: { nombre, doc },
    asiento,
    metodoPago: selectedPayMethod,
    comprobante,
    total,
    cabina: document.getElementById('cabina').value,
    fechaVuelo: document.getElementById('fechaIda').value,
    estado: 'PENDIENTE',
    fecha: new Date().toLocaleString('es-CO'),
    condiciones,
    equipaje
  };
  reservas.push(reserva);
  localStorage.setItem('av_reservas', JSON.stringify(reservas));
  lastReserva = reserva;

  // Guardar evento en log admin
  logAdminEvent('NUEVA_RESERVA', reserva);

  // Mensaje completo al WhatsApp del Admin
  const aptO = getInfoAeropuerto(selectedFlight.origen);
  const aptD = getInfoAeropuerto(selectedFlight.destino);
  const wppMsg =
`âœˆï¸ *NUEVA RESERVA â€” ${reservationCode}*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‘¤ *Pasajero:* ${nombre}
ğŸ“„ *Documento:* ${doc}
ğŸ“§ *Email:* ${user.email || 'N/A'}
ğŸ“± *TelÃ©fono:* ${user.tel || 'N/A'}

âœˆï¸ *Vuelo:* ${selectedFlight.vuelo} | ${selectedFlight.origen} â†’ ${selectedFlight.destino}
ğŸ›« *Aeropuerto salida:* ${aptO.aeropuerto}
ğŸ›¬ *Aeropuerto llegada:* ${aptD.aeropuerto}
ğŸ“… *Fecha vuelo:* ${reserva.fechaVuelo ? formatFecha(reserva.fechaVuelo) : 'â€”'}
ğŸ• *Hora:* ${selectedFlight.hora} â†’ ${selectedFlight.llegada}
â± *DuraciÃ³n:* ${selectedFlight.duracion}
ğŸ’º *Asiento:* ${asiento} | *Cabina:* ${reserva.cabina}

ğŸ§³ *Equipaje mano:* ${equipaje.mano}
ğŸ§³ *Bodega:* ${equipaje.bodega}

ğŸ’° *Total:* ${formatCOP(total)}
ğŸ¦ *MÃ©todo pago:* Llave Bred Bancolombia
ğŸ§¾ *Comprobante:* ${comprobante || 'Sin comprobante aÃºn'}

âš¡ *Estado:* PENDIENTE DE CONFIRMACIÃ“N
ğŸ“… *Reservado el:* ${new Date().toLocaleString('es-CO')}`;

  // Guardar silenciosamente para el admin (sin interrumpir al cliente)
  sendAdminWpp(wppMsg);

  // Enviar notificaciÃ³n a Telegram del admin
  enviarTelegram(wppMsg);

  closeModal('paymentModal');
  showToast(`âœ… Reserva ${reservationCode} confirmada!`, 'success');

  // Mostrar tiquete al cliente
  setTimeout(() => mostrarTiquete(reserva), 500);
}

// ===== GENERAR ASIENTO =====
function generarAsiento(cabina) {
  const filas = cabina === 'Primera clase' ? [1,2,3] : cabina === 'Ejecutiva' ? [4,5,6,7,8] : Array.from({length:20}, (_,i)=>i+10);
  const letras = cabina === 'EconÃ³mica' ? ['A','B','C','D','E','F'] : ['A','B','C','D'];
  const fila = filas[Math.floor(Math.random()*filas.length)];
  const letra = letras[Math.floor(Math.random()*letras.length)];
  return `${fila}${letra}`;
}

// ===== EQUIPAJE SEGÃšN CABINA =====
function getEquipaje(cabina) {
  if (cabina === 'Primera clase') return { mano: '18 kg', bodega: '2 maletas Ã— 32 kg' };
  if (cabina === 'Ejecutiva')    return { mano: '14 kg', bodega: '1 maleta Ã— 23 kg' };
  return { mano: '10 kg', bodega: 'No incluida (add-on disponible)' };
}

// ===== CONDICIONES ESPECIALES =====
function getCondiciones(cabina, metodo) {
  const base = cabina === 'EconÃ³mica'
    ? 'Tarifa no reembolsable. Cambios con cargo de $80.000 COP hasta 24h antes del vuelo. Check-in disponible desde 48h antes.'
    : cabina === 'Ejecutiva'
    ? 'Un cambio gratuito permitido. Reembolso del 50% hasta 48h antes. Acceso a sala VIP incluido.'
    : 'Cambios y cancelaciÃ³n sin cargo hasta 72h antes. Reembolso total disponible. Sala VIP + lounge incluidos.';
  return base + ' El pago queda sujeto a verificaciÃ³n del comprobante antes de confirmar el tiquete final.';
}

// ===== MOSTRAR TIQUETE =====
function mostrarTiquete(reserva) {
  const v = reserva.vuelo;
  const eq = reserva.equipaje || getEquipaje(reserva.cabina);
  const methodNames = { nequi:'Nequi ğŸ’œ', daviplata:'Daviplata ğŸ’›', transferencia:'Transferencia ğŸ¦' };

  const aptO = getInfoAeropuerto(v.origen);
  const aptD = getInfoAeropuerto(v.destino);

  document.getElementById('tktCodigo').textContent     = reserva.codigo;
  document.getElementById('tktOrigen').textContent     = v.origen;
  document.getElementById('tktOrigenNombre').textContent = aptO.ciudad;
  document.getElementById('tktDestino').textContent    = v.destino;
  document.getElementById('tktDestinoNombre').textContent = aptD.ciudad;
  document.getElementById('tktDuracion').textContent   = v.duracion;
  document.getElementById('tktPasajero').textContent   = reserva.pasajero.nombre;
  document.getElementById('tktDoc').textContent        = reserva.pasajero.doc;
  document.getElementById('tktAptOrigen').textContent  = aptO.aeropuerto + (aptO.pais ? ' Â· ' + aptO.pais : '');
  document.getElementById('tktTermOrigen').textContent = aptO.terminal || 'â€”';
  document.getElementById('tktAptDestino').textContent = aptD.aeropuerto + (aptD.pais ? ' Â· ' + aptD.pais : '');
  document.getElementById('tktTermDestino').textContent = aptD.terminal || 'â€”';
  document.getElementById('tktFecha').textContent      = reserva.fechaVuelo ? formatFecha(reserva.fechaVuelo) : 'â€”';
  document.getElementById('tktHora').textContent       = v.hora;
  document.getElementById('tktLlegada').textContent    = v.llegada;
  document.getElementById('tktAerolinea').textContent  = v.aerolinea + ' Â· ' + (v.vuelo || '');
  document.getElementById('tktAsiento').textContent    = reserva.asiento || 'â€”';
  document.getElementById('tktCabina').textContent     = reserva.cabina || 'EconÃ³mica';
  document.getElementById('tktHandbag').textContent    = eq.mano;
  document.getElementById('tktBaggage').textContent    = eq.bodega;
  document.getElementById('tktMetodoPago').textContent = methodNames[reserva.metodoPago] || reserva.metodoPago;
  document.getElementById('tktTotal').textContent      = formatCOP(reserva.total);
  document.getElementById('tktCondiciones').textContent = reserva.condiciones;

  openModal('ticketModal');
}

// ===== BASE DE DATOS AEROPUERTOS â€” IATA OFICIALES =====
const AEROPUERTOS = {
  // â”€â”€ COLOMBIA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  BOG: { ciudad:'BogotÃ¡',          aeropuerto:'Aeropuerto Internacional El Dorado',           terminal:'Terminal 1 (El Dorado)',         pais:'Colombia',         icao:'SKBO' },
  MED: { ciudad:'MedellÃ­n',        aeropuerto:'Aeropuerto Internacional JosÃ© M. CÃ³rdova',      terminal:'Terminal Nacional',             pais:'Colombia',         icao:'SKRG' },
  CTG: { ciudad:'Cartagena',       aeropuerto:'Aeropuerto Internacional Rafael NÃºÃ±ez',         terminal:'Terminal Ãšnica',                pais:'Colombia',         icao:'SKCG' },
  CLO: { ciudad:'Cali',            aeropuerto:'Aeropuerto Internacional Alfonso Bonilla AragÃ³n',terminal:'Terminal Ãšnica',               pais:'Colombia',         icao:'SKCL' },
  BAQ: { ciudad:'Barranquilla',    aeropuerto:'Aeropuerto Internacional Ernesto Cortissoz',    terminal:'Terminal Ãšnica',                pais:'Colombia',         icao:'SKBQ' },
  ADZ: { ciudad:'San AndrÃ©s',      aeropuerto:'Aeropuerto Internacional Gustavo Rojas Pinilla',terminal:'Terminal Ãšnica',               pais:'Colombia',         icao:'SKSP' },
  SMR: { ciudad:'Santa Marta',     aeropuerto:'Aeropuerto Internacional SimÃ³n BolÃ­var',        terminal:'Terminal Ãšnica',                pais:'Colombia',         icao:'SKSM' },
  PEI: { ciudad:'Pereira',         aeropuerto:'Aeropuerto Internacional MatecaÃ±a',             terminal:'Terminal Ãšnica',                pais:'Colombia',         icao:'SKPE' },
  BGA: { ciudad:'Bucaramanga',     aeropuerto:'Aeropuerto Internacional Palonegro',            terminal:'Terminal Ãšnica',                pais:'Colombia',         icao:'SKBG' },
  EOH: { ciudad:'MedellÃ­n',        aeropuerto:'Aeropuerto Olaya Herrera',                      terminal:'Terminal Ãšnica (vuelos regionales)',pais:'Colombia',     icao:'SKMD' },
  VVC: { ciudad:'Villavicencio',   aeropuerto:'Aeropuerto Vanguardia',                         terminal:'Terminal Ãšnica',                pais:'Colombia',         icao:'SVVP' },
  CUC: { ciudad:'CÃºcuta',          aeropuerto:'Aeropuerto Internacional Camilo Daza',           terminal:'Terminal Ãšnica',               pais:'Colombia',         icao:'SKCC' },
  IBE: { ciudad:'IbaguÃ©',          aeropuerto:'Aeropuerto Nacional Perales',                   terminal:'Terminal Ãšnica',                pais:'Colombia',         icao:'SKIB' },
  MZL: { ciudad:'Manizales',       aeropuerto:'Aeropuerto La Nubia',                           terminal:'Terminal Ãšnica',                pais:'Colombia',         icao:'SKMZ' },
  NVA: { ciudad:'Neiva',           aeropuerto:'Aeropuerto Benito Salas',                       terminal:'Terminal Ãšnica',                pais:'Colombia',         icao:'SKNV' },

  // â”€â”€ ESTADOS UNIDOS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  MIA: { ciudad:'Miami',           aeropuerto:'Miami International Airport',                   terminal:'Terminal J (Internacional)',    pais:'EE.UU.',            icao:'KMIA' },
  JFK: { ciudad:'Nueva York',      aeropuerto:'John F. Kennedy International Airport',         terminal:'Terminal 4 (Internacional)',    pais:'EE.UU.',            icao:'KJFK' },
  LAX: { ciudad:'Los Ãngeles',     aeropuerto:'Los Angeles International Airport',             terminal:'Terminal B (Internacional)',    pais:'EE.UU.',            icao:'KLAX' },
  ORD: { ciudad:'Chicago',         aeropuerto:"Chicago O'Hare International Airport",          terminal:'Terminal 5 (Internacional)',    pais:'EE.UU.',            icao:'KORD' },
  MCO: { ciudad:'Orlando',         aeropuerto:'Orlando International Airport',                 terminal:'Terminal A/B',                  pais:'EE.UU.',            icao:'KMCO' },

  // â”€â”€ EUROPA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  MAD: { ciudad:'Madrid',          aeropuerto:'Aeropuerto Adolfo SuÃ¡rez Madrid-Barajas',       terminal:'Terminal 4 (T4)',               pais:'EspaÃ±a',            icao:'LEMD' },
  BCN: { ciudad:'Barcelona',       aeropuerto:'Aeropuerto El Prat â€“ Josep Tarradellas',        terminal:'Terminal 1 (T1)',               pais:'EspaÃ±a',            icao:'LEBL' },
  LHR: { ciudad:'Londres',         aeropuerto:'London Heathrow Airport',                       terminal:'Terminal 2 (Queen\'s)',         pais:'Reino Unido',       icao:'EGLL' },
  CDG: { ciudad:'ParÃ­s',           aeropuerto:'AÃ©roport Paris-Charles de Gaulle',              terminal:'Terminal 2E',                   pais:'Francia',           icao:'LFPG' },
  FCO: { ciudad:'Roma',            aeropuerto:'Aeroporto di Roma Fiumicino',                   terminal:'Terminal 3 (Internazionale)',   pais:'Italia',            icao:'LIRF' },

  // â”€â”€ LATINOAMÃ‰RICA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  LIM: { ciudad:'Lima',            aeropuerto:'Aeropuerto Internacional Jorge ChÃ¡vez',         terminal:'Terminal Internacional',        pais:'PerÃº',              icao:'SPJC' },
  GRU: { ciudad:'SÃ£o Paulo',       aeropuerto:'Aeroporto Internacional de Guarulhos',          terminal:'Terminal 3',                    pais:'Brasil',            icao:'SBGR' },
  EZE: { ciudad:'Buenos Aires',    aeropuerto:'Aeropuerto Internacional Ministro Pistarini',   terminal:'Terminal A',                    pais:'Argentina',         icao:'SAEZ' },
  GIG: { ciudad:'RÃ­o de Janeiro',  aeropuerto:'Aeroporto Internacional do GaleÃ£o',             terminal:'Terminal 2',                    pais:'Brasil',            icao:'SBGL' },
  SCL: { ciudad:'Santiago',        aeropuerto:'Aeropuerto Internacional Arturo Merino BenÃ­tez',terminal:'Terminal Internacional',        pais:'Chile',             icao:'SCEL' },
  UIO: { ciudad:'Quito',           aeropuerto:'Aeropuerto Internacional Mariscal Sucre',       terminal:'Terminal Ãšnica',                pais:'Ecuador',           icao:'SEQM' },
  GYE: { ciudad:'Guayaquil',       aeropuerto:'Aeropuerto Internacional JosÃ© JoaquÃ­n de Olmedo',terminal:'Terminal Ãšnica',              pais:'Ecuador',           icao:'SEGU' },
  PTY: { ciudad:'Ciudad de PanamÃ¡',aeropuerto:'Aeropuerto Internacional de Tocumen',           terminal:'Terminal 2 (Nueva)',            pais:'PanamÃ¡',            icao:'MPTO' },
  CCS: { ciudad:'Caracas',         aeropuerto:'Aeropuerto Internacional SimÃ³n BolÃ­var',        terminal:'Terminal Nacional',             pais:'Venezuela',         icao:'SVMI' },
  BOG_VE: { ciudad:'Caracas',      aeropuerto:'Aeropuerto Internacional SimÃ³n BolÃ­var',        terminal:'Terminal Nacional',             pais:'Venezuela',         icao:'SVMI' },
  ASU: { ciudad:'AsunciÃ³n',        aeropuerto:'Aeropuerto Internacional Silvio Pettirossi',    terminal:'Terminal Ãšnica',                pais:'Paraguay',          icao:'SGAS' },

  // â”€â”€ CARIBE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  CUN: { ciudad:'CancÃºn',          aeropuerto:'Aeropuerto Internacional de CancÃºn',            terminal:'Terminal 4 (T4)',               pais:'MÃ©xico',            icao:'MMUN' },
  MEX: { ciudad:'Ciudad de MÃ©xico',aeropuerto:'Aeropuerto Internacional Benito JuÃ¡rez',        terminal:'Terminal 2',                    pais:'MÃ©xico',            icao:'MMMX' },
  PUJ: { ciudad:'Punta Cana',      aeropuerto:'Aeropuerto Internacional de Punta Cana',        terminal:'Terminal A',                    pais:'Rep. Dominicana',   icao:'MDPC' },
  SDQ: { ciudad:'Santo Domingo',   aeropuerto:'Aeropuerto Internacional Las AmÃ©ricas',         terminal:'Terminal A',                    pais:'Rep. Dominicana',   icao:'MDSD' },
  HAV: { ciudad:'La Habana',       aeropuerto:'Aeropuerto Internacional JosÃ© MartÃ­',           terminal:'Terminal 2 (Internacional)',    pais:'Cuba',              icao:'MUHA' },
  AUA: { ciudad:'Aruba',           aeropuerto:'Aeropuerto Internacional Reina Beatrix',        terminal:'Terminal Ãšnica',                pais:'Aruba',             icao:'TNCA' },
  SJU: { ciudad:'San Juan',        aeropuerto:'Aeropuerto Internacional Luis MuÃ±oz MarÃ­n',     terminal:'Terminal D (JetBlue)',          pais:'Puerto Rico',       icao:'TJSJ' },
};

function getNombreCiudad(iata) {
  return AEROPUERTOS[iata] ? AEROPUERTOS[iata].ciudad : iata;
}

function getInfoAeropuerto(iata) {
  return AEROPUERTOS[iata] || { ciudad: iata, aeropuerto: 'Aeropuerto Internacional', terminal: 'â€”', pais: '', icao: '' };
}

function formatFecha(iso) {
  if (!iso) return 'â€”';
  const [y,m,d] = iso.split('-');
  const meses = ['Ene','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'];
  return `${d} ${meses[parseInt(m)-1]} ${y}`;
}

// ===== DESCARGAR PDF =====
function descargarTiquetePDF() {
  const r = lastReserva;
  if (!r) return;
  const v = r.vuelo;
  const eq = r.equipaje || getEquipaje(r.cabina);
  const methodNames = { nequi:'Nequi', daviplata:'Daviplata', transferencia:'Transferencia bancaria' };
  const aptO = getInfoAeropuerto(v.origen);
  const aptD = getInfoAeropuerto(v.destino);

  const html = `<!DOCTYPE html>
<html><head><meta charset="UTF-8">
<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 30px; color: #1a1a1a; background:#fff; }
  .header { background: linear-gradient(135deg,#B71C1C,#D32F2F); color: white; padding: 24px 28px; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center; }
  .header .airline { font-size: 24px; font-weight: 900; }
  .header .code { text-align: right; }
  .header .code small { font-size: 11px; opacity: 0.8; display: block; text-transform: uppercase; letter-spacing: 1px; }
  .header .code span { font-size: 26px; font-weight: 700; letter-spacing: 3px; }
  .body { border: 2px dashed #ddd; border-top: none; border-radius: 0 0 12px 12px; padding: 24px 28px; background: #fafafa; }
  .route { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; text-align: center; }
  .iata { font-size: 36px; font-weight: 900; }
  .city-name { font-size: 13px; font-weight: 700; color: #222; }
  .apt-name { font-size: 11px; color: #888; max-width: 160px; }
  .terminal { font-size: 11px; color: #D32F2F; font-weight: 600; }
  .arrow { font-size: 28px; color: #D32F2F; }
  .dur { font-size: 11px; color: #888; }
  .flight-num { background: #D32F2F; color: white; display: inline-block; padding: 2px 10px; border-radius: 10px; font-size: 12px; font-weight: 700; margin-top: 4px; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 16px; }
  .field label { font-size: 10px; color: #888; text-transform: uppercase; letter-spacing: 0.5px; display: block; margin-bottom: 3px; }
  .field span { font-size: 13px; font-weight: 700; }
  .field span.small { font-size: 11px; }
  hr { border: none; border-top: 2px dashed #ddd; margin: 16px 0; }
  .extras { background: white; border: 1px solid #e8e8e8; border-radius: 8px; padding: 12px; margin-bottom: 14px; }
  .extras h4 { font-size: 11px; color: #888; text-transform: uppercase; letter-spacing: 0.5px; margin: 0 0 10px 0; }
  .row { display: flex; justify-content: space-between; font-size: 13px; padding: 4px 0; border-bottom: 1px solid #f0f0f0; }
  .row:last-child { border-bottom: none; }
  .cond { background: #fff8e1; border: 1px solid #ffe082; border-radius: 8px; padding: 12px; font-size: 12px; color: #795548; line-height: 1.6; }
  .cond strong { display: block; color: #5D4037; margin-bottom: 4px; font-size: 10px; text-transform: uppercase; }
  .footer { text-align: center; margin-top: 20px; font-size: 11px; color: #aaa; border-top: 1px solid #eee; padding-top: 14px; }
</style></head><body>
<div class="header">
  <div>
    <div class="airline">âœˆ AeroVuelos Colombia</div>
    <div style="font-size:12px;opacity:0.8;margin-top:4px">Comprobante de Reserva â€” Estado: PENDIENTE</div>
  </div>
  <div class="code"><small>CÃ³digo de Reserva</small><span>${r.codigo}</span></div>
</div>
<div class="body">
  <div class="route">
    <div>
      <div class="iata">${v.origen}</div>
      <div class="city-name">${aptO.ciudad}</div>
      <div class="apt-name">${aptO.aeropuerto}</div>
      <div class="terminal">${aptO.terminal}</div>
    </div>
    <div style="flex:1;text-align:center;padding:0 12px">
      <div class="arrow">âœˆ</div>
      <div class="dur">${v.duracion}</div>
      <div class="flight-num">${v.vuelo || ''}</div>
    </div>
    <div>
      <div class="iata">${v.destino}</div>
      <div class="city-name">${aptD.ciudad}</div>
      <div class="apt-name">${aptD.aeropuerto}</div>
      <div class="terminal">${aptD.terminal}</div>
    </div>
  </div>
  <div class="grid">
    <div class="field"><label>Pasajero</label><span>${r.pasajero.nombre}</span></div>
    <div class="field"><label>Documento</label><span>${r.pasajero.doc}</span></div>
    <div class="field"><label>Aeropuerto de salida</label><span class="small">${aptO.aeropuerto}</span></div>
    <div class="field"><label>Terminal de salida</label><span class="small">${aptO.terminal} Â· ${aptO.icao || ''}</span></div>
    <div class="field"><label>Aeropuerto de llegada</label><span class="small">${aptD.aeropuerto}</span></div>
    <div class="field"><label>Terminal de llegada</label><span class="small">${aptD.terminal} Â· ${aptD.icao || ''}</span></div>
    <div class="field"><label>Fecha de vuelo</label><span>${r.fechaVuelo ? formatFecha(r.fechaVuelo) : 'â€”'}</span></div>
    <div class="field"><label>Hora de salida</label><span>${v.hora} (${aptO.pais})</span></div>
    <div class="field"><label>Hora de llegada</label><span>${v.llegada} (${aptD.pais})</span></div>
    <div class="field"><label>NÂ° de vuelo</label><span>${v.vuelo || 'â€”'}</span></div>
    <div class="field"><label>AerolÃ­nea</label><span>${v.aerolinea}</span></div>
    <div class="field"><label>Asiento</label><span>${r.asiento || 'â€”'}</span></div>
    <div class="field"><label>Cabina</label><span>${r.cabina || 'EconÃ³mica'}</span></div>
  </div>
  <hr>
  <div class="extras">
    <h4>ğŸ§³ Equipaje y servicios incluidos</h4>
    <div class="row"><span>Equipaje de mano</span><span>${eq.mano}</span></div>
    <div class="row"><span>Maleta en bodega</span><span>${eq.bodega}</span></div>
    <div class="row"><span>MÃ©todo de pago</span><span>${methodNames[r.metodoPago] || r.metodoPago}</span></div>
    <div class="row"><span style="font-weight:700">Total pagado</span><span style="color:#D32F2F;font-weight:700">${formatCOP(r.total)}</span></div>
  </div>
  <div class="cond">
    <strong>ğŸ“‹ Condiciones especiales de la tarifa</strong>
    ${r.condiciones}
  </div>
</div>
<div class="footer">
  AeroVuelos Colombia &nbsp;Â·&nbsp; Reserva generada el ${new Date().toLocaleString('es-CO')}<br>
  Este documento es vÃ¡lido como comprobante de reserva Â· <strong>Estado: PENDIENTE DE CONFIRMACIÃ“N</strong>
</div>
</body></html>`;

  const blob = new Blob([html], { type: 'text/html' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `AeroVuelos_Reserva_${r.codigo}.html`;
  a.click();
  URL.revokeObjectURL(url);
  showToast('ğŸ“„ Tiquete descargado!', 'success');
}

// ===== COMPARTIR POR WHATSAPP =====
function compartirWhatsApp() {
  const r = lastReserva;
  if (!r) return;
  const v = r.vuelo;
  const text = encodeURIComponent(
    `âœˆï¸ *AeroVuelos â€” Reserva ${r.codigo}*\n\n` +
    `ğŸ‘¤ Pasajero: ${r.pasajero.nombre}\n` +
    `âœˆï¸ Vuelo: ${v.origen} â†’ ${v.destino}\n` +
    `ğŸ“… Fecha: ${r.fechaVuelo ? formatFecha(r.fechaVuelo) : 'â€”'}\n` +
    `ğŸ• Hora: ${v.hora} â†’ ${v.llegada}\n` +
    `ğŸ’º Asiento: ${r.asiento} (${r.cabina})\n` +
    `ğŸ’° Total: ${formatCOP(r.total)}\n` +
    `âš¡ Estado: PENDIENTE DE CONFIRMACIÃ“N\n\n` +
    `Â¿Tienes dudas? EscrÃ­benos al WhatsApp: ${CONFIG.wppContacto}`
  );
  window.open(`https://wa.me/?text=${text}`, '_blank');
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PANEL ADMINISTRADOR â€” Control total por WhatsApp
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function adminLogin() {
  const pwd = document.getElementById('adminPwd').value;
  if (pwd === CONFIG.adminPassword) {
    document.getElementById('adminLoginView').style.display = 'none';
    document.getElementById('adminMainView').style.display = 'block';
    cargarDatosAdmin();
    // Notificar acceso admin
    logAdminEvent('ACCESO_ADMIN', { fecha: new Date().toLocaleString('es-CO') });
  } else {
    document.getElementById('adminPwd').style.borderColor = '#e94560';
    document.getElementById('adminPwd').placeholder = 'âŒ ContraseÃ±a incorrecta';
    setTimeout(() => {
      document.getElementById('adminPwd').style.borderColor = '';
      document.getElementById('adminPwd').placeholder = 'ContraseÃ±a de admin';
    }, 2000);
  }
}

function closeAdmin() {
  document.getElementById('adminPanel').classList.remove('active');
  document.getElementById('adminLoginView').style.display = 'block';
  document.getElementById('adminMainView').style.display = 'none';
  document.getElementById('adminPwd').value = '';
}

function adminTab(el, tabId) {
  document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  document.getElementById(tabId).classList.add('active');
}

function cargarDatosAdmin() {
  const reservas = JSON.parse(localStorage.getItem('av_reservas') || '[]');
  const usuarios = JSON.parse(localStorage.getItem('av_users') || '[]');
  const eventos  = JSON.parse(localStorage.getItem('av_admin_log') || '[]');

  // Stats
  const totalIngresos = reservas.reduce((s, r) => s + (r.total || 0), 0);
  const colaWpp = JSON.parse(localStorage.getItem('av_wpp_cola') || '[]');
  const pendientesWpp = colaWpp.filter(m => !m.enviado).length;
  document.getElementById('statReservas').textContent = reservas.length;
  document.getElementById('statUsuarios').textContent = usuarios.length;
  document.getElementById('statIngresos').textContent = reservas.length > 0
    ? '$' + Math.round(totalIngresos/1000) + 'K'
    : '$0';
  if (document.getElementById('statPendientesWpp')) {
    document.getElementById('statPendientesWpp').textContent = pendientesWpp > 0
      ? pendientesWpp + ' nuevas ğŸ”´'
      : 'âœ… Al dÃ­a';
  }

  // Lista reservas
  const lr = document.getElementById('listaReservas');
  if (reservas.length === 0) {
    lr.innerHTML = '<div id="adminNoData">Sin reservas aÃºn</div>';
  } else {
    lr.innerHTML = [...reservas].reverse().map(r => {
      const v = r.vuelo || {};
      const aptO = getInfoAeropuerto(v.origen || '');
      const aptD = getInfoAeropuerto(v.destino || '');
      return `
      <div class="admin-res-card">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px">
          <div>
            <span class="res-code">${r.codigo}</span>
            <span class="res-estado pendiente" style="margin-left:8px">${r.estado || 'PENDIENTE'}</span>
          </div>
          <button class="admin-wpp-btn" onclick="enviarReservaWpp('${r.codigo}')">ğŸ“² Enviar a mi WPP</button>
        </div>
        <div class="res-ruta">${v.origen || 'â€”'} â†’ ${v.destino || 'â€”'} Â· ${v.vuelo || ''}</div>
        <div class="res-info">
          ğŸ‘¤ ${r.pasajero?.nombre || 'â€”'} Â· ğŸ“„ ${r.pasajero?.doc || 'â€”'}<br>
          ğŸ“§ ${r.usuario?.email || 'â€”'} Â· ğŸ“± ${r.usuario?.tel || 'â€”'}<br>
          ğŸ›« ${aptO.aeropuerto}<br>
          ğŸ›¬ ${aptD.aeropuerto}<br>
          ğŸ“… ${r.fechaVuelo ? formatFecha(r.fechaVuelo) : 'â€”'} Â· ğŸ• ${v.hora || 'â€”'} â†’ ${v.llegada || 'â€”'}<br>
          ğŸ’º Asiento: ${r.asiento || 'â€”'} Â· Cabina: ${r.cabina || 'â€”'}<br>
          ğŸ’° Total: <b style="color:#e94560">${formatCOP(r.total || 0)}</b> Â· ğŸ¦ Llave Bred<br>
          ğŸ§¾ Comprobante: ${r.comprobante || 'Sin comprobante'}<br>
          ğŸ“‹ Reservado: ${r.fecha || 'â€”'}
        </div>
      </div>`;
    }).join('');
  }

  // Lista usuarios
  const lu = document.getElementById('listaUsuarios');
  if (usuarios.length === 0) {
    lu.innerHTML = '<div id="adminNoData">Sin usuarios registrados</div>';
  } else {
    lu.innerHTML = [...usuarios].reverse().map(u => `
      <div class="admin-user-card">
        <div>
          <div class="u-name">ğŸ‘¤ ${u.nombre}</div>
          <div class="u-info">ğŸ“§ ${u.email} Â· ğŸ“± ${u.tel}</div>
        </div>
        <button class="admin-wpp-btn" onclick="window.open('https://wa.me/57${u.tel?.replace(/\D/g,'')}','_blank')">
          ğŸ’¬ WPP
        </button>
      </div>`).join('');
  }

  // Log actividad
  const ll = document.getElementById('listaLog');
  if (eventos.length === 0) {
    ll.innerHTML = '<div id="adminNoData">Sin actividad registrada</div>';
  } else {
    const iconos = {
      NUEVA_RESERVA: { icon:'âœˆï¸', cls:''},
      NUEVO_REGISTRO: { icon:'ğŸ‘¤', cls:'registro'},
      BUSQUEDA: { icon:'ğŸ”', cls:'busqueda'},
      ACCESO_ADMIN: { icon:'ğŸ”', cls:''},
    };
    ll.innerHTML = eventos.slice(0, 80).map(ev => {
      const info = iconos[ev.tipo] || { icon:'ğŸ“Œ', cls:'' };
      let detalle = '';
      if (ev.tipo === 'NUEVA_RESERVA') {
        detalle = `Reserva <b>${ev.datos?.codigo}</b> â€” ${ev.datos?.pasajero?.nombre} â€” ${ev.datos?.vuelo?.origen}â†’${ev.datos?.vuelo?.destino} â€” ${formatCOP(ev.datos?.total||0)}`;
      } else if (ev.tipo === 'NUEVO_REGISTRO') {
        detalle = `${ev.datos?.nombre} Â· ${ev.datos?.email} Â· ${ev.datos?.tel}`;
      } else if (ev.tipo === 'BUSQUEDA') {
        detalle = `BÃºsqueda: ${ev.datos?.origen} â†’ ${ev.datos?.destino} | ${ev.datos?.fecha}`;
      } else if (ev.tipo === 'ACCESO_ADMIN') {
        detalle = `Acceso al panel administrador`;
      } else {
        detalle = JSON.stringify(ev.datos || {}).substring(0, 80);
      }
      return `
      <div class="admin-event ${info.cls}">
        <div class="ev-type">${info.icon} ${ev.tipo.replace(/_/g,' ')}</div>
        <div class="ev-detail">${detalle}</div>
        <div class="ev-fecha">ğŸ• ${ev.fecha}</div>
      </div>`;
    }).join('');
  }
}

// Enviar reserva especÃ­fica a WPP admin
function enviarReservaWpp(codigo) {
  const reservas = JSON.parse(localStorage.getItem('av_reservas') || '[]');
  const r = reservas.find(x => x.codigo === codigo);
  if (!r) return;
  const v = r.vuelo || {};
  const aptO = getInfoAeropuerto(v.origen || '');
  const aptD = getInfoAeropuerto(v.destino || '');
  const msg =
`âœˆï¸ *RESERVA ${r.codigo}*
ğŸ‘¤ *Pasajero:* ${r.pasajero?.nombre}
ğŸ“„ *Documento:* ${r.pasajero?.doc}
ğŸ“§ *Email:* ${r.usuario?.email || 'N/A'}
ğŸ“± *TelÃ©fono:* ${r.usuario?.tel || 'N/A'}
âœˆï¸ *Vuelo:* ${v.vuelo} | ${v.origen} â†’ ${v.destino}
ğŸ›« ${aptO.aeropuerto}
ğŸ›¬ ${aptD.aeropuerto}
ğŸ“… *Fecha:* ${r.fechaVuelo ? formatFecha(r.fechaVuelo) : 'â€”'}
ğŸ• *Hora:* ${v.hora} â†’ ${v.llegada}
ğŸ’º *Asiento:* ${r.asiento} | ${r.cabina}
ğŸ’° *Total:* ${formatCOP(r.total || 0)}
ğŸ¦ *Pago:* Llave Bred Bancolombia
ğŸ§¾ *Comprobante:* ${r.comprobante || 'Sin comprobante'}
ğŸ“‹ *Estado:* ${r.estado || 'PENDIENTE'}`;
  abrirWppAdmin(msg);
}

// Enviar resumen diario al WPP del admin
function enviarResumenWpp() {
  const reservas = JSON.parse(localStorage.getItem('av_reservas') || '[]');
  const usuarios = JSON.parse(localStorage.getItem('av_users') || '[]');
  const total = reservas.reduce((s, r) => s + (r.total || 0), 0);
  const pendientes = reservas.filter(r => (r.estado || 'PENDIENTE') === 'PENDIENTE').length;

  let msg = `ğŸ“Š *RESUMEN DIARIO â€” AeroVuelos*
ğŸ“… ${new Date().toLocaleString('es-CO')}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœˆï¸ Total reservas: *${reservas.length}*
â³ Pendientes: *${pendientes}*
ğŸ‘¤ Usuarios registrados: *${usuarios.length}*
ğŸ’° Ingresos estimados: *${formatCOP(total)}*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
`;

  if (reservas.length > 0) {
    msg += `\n*Ãšltimas reservas:*\n`;
    [...reservas].reverse().slice(0, 5).forEach(r => {
      const v = r.vuelo || {};
      msg += `â€¢ ${r.codigo} â€” ${r.pasajero?.nombre} â€” ${v.origen}â†’${v.destino} â€” ${formatCOP(r.total||0)}\n`;
    });
  }
  abrirWppAdmin(msg);
}


// Ver y enviar reservas nuevas pendientes al WPP del admin
function enviarTodasPendientesWpp() {
  const reservas = JSON.parse(localStorage.getItem('av_reservas') || '[]');
  const colaWpp  = JSON.parse(localStorage.getItem('av_wpp_cola') || '[]');
  const pendientes = colaWpp.filter(m => !m.enviado);

  if (pendientes.length === 0) {
    // Mostrar las Ãºltimas 3 reservas si no hay pendientes
    const ultimas = [...reservas].reverse().slice(0, 3);
    if (ultimas.length === 0) { alert('No hay reservas aÃºn.'); return; }
    const r = ultimas[0];
    const v = r.vuelo || {};
    const msg = `ğŸ“‹ *ÃšLTIMAS RESERVAS â€” AeroVuelos*\nğŸ“… ${new Date().toLocaleString('es-CO')}\n\n` +
      ultimas.map(r => {
        const v = r.vuelo || {};
        return `â€¢ *${r.codigo}* â€” ${r.pasajero?.nombre}\n  ${v.origen}â†’${v.destino} Â· ${formatCOP(r.total||0)}\n  ğŸ“± ${r.usuario?.tel || 'N/A'} Â· ğŸ§¾ ${r.comprobante || 'Sin comprobante'}`;
      }).join('\n\n');
    abrirWppAdmin(msg);
    return;
  }

  // Enviar la primera pendiente y marcarla como enviada
  const primero = pendientes[0];
  abrirWppAdmin(primero.mensaje);

  // Marcar como enviado
  const idx = colaWpp.findIndex(m => m === primero || (m.fecha === primero.fecha && !m.enviado));
  if (idx >= 0) colaWpp[idx].enviado = true;
  localStorage.setItem('av_wpp_cola', JSON.stringify(colaWpp));

  // Actualizar contador
  const restantes = colaWpp.filter(m => !m.enviado).length;
  if (document.getElementById('statPendientesWpp')) {
    document.getElementById('statPendientesWpp').textContent = restantes > 0
      ? restantes + ' nuevas ğŸ”´' : 'âœ… Al dÃ­a';
  }
}

// ===== IR A DESTINO (desde tarjetas) =====
function irADestino(nombre) {
  document.getElementById('destino').value = nombre;
  window.scrollTo({ top: 0, behavior: 'smooth' });
  setTimeout(() => document.getElementById('destino').focus(), 600);
}

// ===== INIT =====
window.addEventListener('load', () => {
  updateNavUser();
  // Set default dates
  const today = new Date();
  const next7 = new Date(today);
  next7.setDate(today.getDate() + 7);
  const next14 = new Date(today);
  next14.setDate(today.getDate() + 14);
  document.getElementById('fechaIda').value = next7.toISOString().split('T')[0];
  document.getElementById('fechaVuelta').value = next14.toISOString().split('T')[0];
});
</script>
</body>
</html>
